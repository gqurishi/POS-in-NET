<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="POS_in_NET.Pages.CollectionCustomerModal"
             Title="Collection Order"
             BackgroundColor="#F8F9FA">

    <Grid Padding="50" RowDefinitions="Auto,*,Auto">
        
        <!-- Header -->
        <VerticalStackLayout Grid.Row="0" Spacing="12" Margin="0,0,0,40">
            <Label Text="Collection Order" 
                   FontSize="36" 
                   FontAttributes="Bold" 
                   HorizontalOptions="Center"
                   TextColor="#1A202C"/>
            <Label Text="Customer Information" 
                   FontSize="16" 
                   HorizontalOptions="Center"
                   TextColor="#718096"
                   Margin="0,5,0,0"/>
            <BoxView HeightRequest="3"
                     WidthRequest="60"
                     BackgroundColor="#10B981"
                     HorizontalOptions="Center"
                     CornerRadius="2"
                     Margin="0,10,0,0"/>
        </VerticalStackLayout>

        <!-- Main Content -->
        <ScrollView Grid.Row="1">
            <VerticalStackLayout Spacing="30" HorizontalOptions="Center" WidthRequest="550">
                
                <!-- Customer Name -->
                <VerticalStackLayout Spacing="12">
                    <Label Text="Customer Name" 
                           FontSize="15" 
                           FontAttributes="Bold"
                           TextColor="#4A5568"/>
                    <Border BackgroundColor="White"
                            StrokeThickness="2"
                            Stroke="#E2E8F0"
                            Padding="0">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="12"/>
                        </Border.StrokeShape>
                        <Entry x:Name="CustomerNameEntry"
                               Placeholder="e.g., John Smith"
                               FontSize="16"
                               TextColor="#1A202C"
                               PlaceholderColor="#A0AEC0"
                               HeightRequest="56"
                               Margin="16,0"/>
                    </Border>
                </VerticalStackLayout>

                <!-- Phone Number -->
                <VerticalStackLayout Spacing="12">
                    <Label Text="Phone Number" 
                           FontSize="15" 
                           FontAttributes="Bold"
                           TextColor="#4A5568"/>
                    <Border BackgroundColor="White"
                            StrokeThickness="2"
                            Stroke="#E2E8F0"
                            Padding="0">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="12"/>
                        </Border.StrokeShape>
                        <Entry x:Name="PhoneNumberEntry"
                               Placeholder="e.g., 07123 456789"
                               Keyboard="Telephone"
                               FontSize="16"
                               TextColor="#1A202C"
                               PlaceholderColor="#A0AEC0"
                               HeightRequest="56"
                               Margin="16,0"/>
                    </Border>
                </VerticalStackLayout>

                <!-- Search Button -->
                <Button Text="Search Existing Customer"
                        BackgroundColor="#3B82F6"
                        TextColor="White"
                        FontSize="16"
                        HeightRequest="54"
                        CornerRadius="12"
                        Clicked="OnSearchClicked"
                        Margin="0,5,0,0">
                    <Button.Shadow>
                        <Shadow Brush="#3B82F6" 
                                Radius="8" 
                                Opacity="0.3" 
                                Offset="0,4"/>
                    </Button.Shadow>
                </Button>

                <!-- Search Results -->
                <Border x:Name="SearchResultsBorder"
                        IsVisible="False"
                        BackgroundColor="White"
                        StrokeThickness="2"
                        Stroke="#E2E8F0"
                        Padding="0"
                        MaximumHeightRequest="320"
                        Margin="0,5,0,0">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="12"/>
                    </Border.StrokeShape>
                    <Border.Shadow>
                        <Shadow Brush="Black" 
                                Radius="12" 
                                Opacity="0.08" 
                                Offset="0,4"/>
                    </Border.Shadow>
                    <ScrollView>
                        <CollectionView x:Name="SearchResultsCollection"
                                        SelectionMode="Single"
                                        SelectionChanged="OnCustomerSelected">
                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <Border Padding="18,16"
                                            BackgroundColor="Transparent"
                                            Margin="0,0,0,1">
                                        <Border.GestureRecognizers>
                                            <TapGestureRecognizer Tapped="OnCustomerTapped"/>
                                        </Border.GestureRecognizers>
                                        <Grid ColumnDefinitions="*,Auto" ColumnSpacing="12">
                                            <VerticalStackLayout Grid.Column="0" Spacing="6">
                                                <Label Text="{Binding Name}" 
                                                       FontSize="16" 
                                                       FontAttributes="Bold"
                                                       TextColor="#1A202C"/>
                                                <Label Text="{Binding PhoneNumber}" 
                                                       FontSize="14"
                                                       TextColor="#718096"/>
                                            </VerticalStackLayout>
                                            <Label Grid.Column="1"
                                                   Text="â†’"
                                                   FontSize="22"
                                                   TextColor="#10B981"
                                                   VerticalOptions="Center"/>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>
                    </ScrollView>
                </Border>

                <!-- No Results Message -->
                <Border x:Name="NoResultsLabel"
                        IsVisible="False"
                        BackgroundColor="#FEF2F2"
                        StrokeThickness="2"
                        Stroke="#FEE2E2"
                        Padding="20"
                        Margin="0,5,0,0">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="12"/>
                    </Border.StrokeShape>
                    <Label Text="No customers found matching your search"
                           FontSize="15"
                           TextColor="#DC2626"
                           HorizontalOptions="Center"
                           HorizontalTextAlignment="Center"/>
                </Border>

            </VerticalStackLayout>
        </ScrollView>

        <!-- Bottom Buttons -->
        <Grid Grid.Row="2" 
              ColumnDefinitions="*,1.2*" 
              ColumnSpacing="16" 
              Margin="0,40,0,0"
              HorizontalOptions="Center"
              WidthRequest="550">
            
            <Button Grid.Column="0"
                    Text="Cancel"
                    BackgroundColor="White"
                    TextColor="#64748B"
                    FontSize="16"
                    HeightRequest="56"
                    CornerRadius="12"
                    BorderColor="#E2E8F0"
                    BorderWidth="2"
                    Clicked="OnCancelClicked"/>

            <Button Grid.Column="1"
                    Text="Continue to Order"
                    BackgroundColor="#10B981"
                    TextColor="White"
                    FontSize="16"
                    FontAttributes="Bold"
                    HeightRequest="56"
                    CornerRadius="12"
                    Clicked="OnContinueClicked">
                <Button.Shadow>
                    <Shadow Brush="#10B981" 
                            Radius="10" 
                            Opacity="0.35" 
                            Offset="0,4"/>
                </Button.Shadow>
            </Button>
        </Grid>

    </Grid>
</ContentPage>
