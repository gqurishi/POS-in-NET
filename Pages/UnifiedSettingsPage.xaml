<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:controls="clr-namespace:POS_in_NET.Controls"
             xmlns:views="clr-namespace:POS_in_NET.Views"
             xmlns:converters="clr-namespace:POS_in_NET.Converters"
             x:Class="POS_in_NET.Pages.UnifiedSettingsPage"
             Title="Settings"
             BackgroundColor="#F8F9FA">

    <ContentPage.Resources>
        <ResourceDictionary>
            <converters:FirstLetterConverter x:Key="FirstLetterConverter"/>
        </ResourceDictionary>
    </ContentPage.Resources>

    <Grid RowDefinitions="Auto,Auto,Auto,*" RowSpacing="0">
        
        <!-- Top Navigation Bar -->
        <views:TopBar x:Name="TopBar" Grid.Row="0"/>
        
        <!-- Loading Indicator -->
        <Grid x:Name="LoadingIndicator" Grid.Row="0" Grid.RowSpan="4" 
              IsVisible="False" 
              BackgroundColor="#80000000">
            <ActivityIndicator IsRunning="True" Color="White" />
        </Grid>
        
        <!-- Toast Notification -->
        <controls:ToastNotification x:Name="ToastNotification" 
                                    Grid.Row="1"
                                    IsVisible="False" />
        
        <!-- Elegant Professional Tab Bar -->
        <Border Grid.Row="2" 
                BackgroundColor="White"
                Padding="0"
                Stroke="#F1F5F9"
                StrokeThickness="1">
            <Border.Shadow>
                <Shadow Brush="#E2E8F0" Radius="8" Opacity="0.06" Offset="0,2"/>
            </Border.Shadow>
            
            <Grid ColumnDefinitions="*,*,*" Padding="2,2,2,2" ColumnSpacing="2">
                
                <!-- Business Info Tab -->
                <Border x:Name="BusinessTabBorder"
                        Grid.Column="0"
                        BackgroundColor="#3B82F6"
                        Padding="0"
                        HeightRequest="56">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="12"/>
                    </Border.StrokeShape>
                    <Border.Shadow>
                        <Shadow Brush="#3B82F6" Radius="12" Opacity="0.20" Offset="0,3"/>
                    </Border.Shadow>
                    <Grid>
                        <!-- Active indicator -->
                        <Rectangle Fill="#1E40AF" 
                                   HeightRequest="3" 
                                   VerticalOptions="End"
                                   Margin="16,0,16,0"/>
                        <Button BackgroundColor="Transparent"
                                TextColor="White"
                                Text="Business Info"
                                FontSize="15"
                                FontAttributes="Bold"
                                Padding="24,0"
                                Clicked="OnBusinessTabClicked"/>
                    </Grid>
                </Border>
                
                <!-- User Management Tab -->
                <Border x:Name="UserTabBorder"
                        Grid.Column="1"
                        BackgroundColor="Transparent"
                        Padding="0"
                        HeightRequest="56">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="12"/>
                    </Border.StrokeShape>
                    <Grid>
                        <!-- Hover effect background -->
                        <Rectangle Fill="#F8FAFC" 
                                   Opacity="0"/>
                        <Button BackgroundColor="Transparent"
                                TextColor="#475569"
                                Text="User Management"
                                FontSize="15"
                                FontAttributes="Bold"
                                Padding="24,0"
                                Clicked="OnUserTabClicked"/>
                    </Grid>
                </Border>
                
                <!-- OrderWeb Tab -->
                <Border x:Name="OrderWebTabBorder"
                        Grid.Column="2"
                        BackgroundColor="Transparent"
                        Padding="0"
                        HeightRequest="56">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="12"/>
                    </Border.StrokeShape>
                    <Grid>
                        <!-- Hover effect background -->
                        <Rectangle Fill="#F8FAFC" 
                                   Opacity="0"/>
                        <Button BackgroundColor="Transparent"
                                TextColor="#475569"
                                Text="OrderWeb"
                                FontSize="15"
                                FontAttributes="Bold"
                                Padding="24,0"
                                Clicked="OnOrderWebTabClicked"/>
                    </Grid>
                </Border>
                
            </Grid>
        </Border>
        
        <!-- Content Area -->
        <ScrollView Grid.Row="3" x:Name="MainScrollView" BackgroundColor="#F8F9FA">
            <StackLayout Padding="0">
                
                <!-- Business Info Content -->
                <StackLayout x:Name="BusinessInfoContent" IsVisible="True" Padding="32,32,32,0">
                    
                    <!-- Enhanced Header -->
                    <Border BackgroundColor="White" 
                            Padding="0,32,0,28"
                            Margin="0,0,0,28">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="20"/>
                        </Border.StrokeShape>
                        <Border.Shadow>
                            <Shadow Brush="#E5E7EB" Radius="20" Opacity="0.08" Offset="0,6"/>
                        </Border.Shadow>
                        <StackLayout>
                            <!-- Modern icon with gradient -->
                            <Border BackgroundColor="#3B82F6"
                                    WidthRequest="64"
                                    HeightRequest="64"
                                    HorizontalOptions="Center"
                                    Margin="0,0,0,16">
                                <Border.StrokeShape>
                                    <RoundRectangle CornerRadius="16"/>
                                </Border.StrokeShape>
                                <Border.Shadow>
                                    <Shadow Brush="#3B82F6" Radius="16" Opacity="0.25" Offset="0,4"/>
                                </Border.Shadow>
                                <Label Text="BI" 
                                       FontSize="24" 
                                       FontAttributes="Bold" 
                                       TextColor="White"
                                       HorizontalOptions="Center"
                                       VerticalOptions="Center"/>
                            </Border>
                            <Label Text="Business Information" 
                                   FontSize="28" 
                                   FontAttributes="Bold" 
                                   TextColor="#0F172A"
                                   HorizontalOptions="Center"
                                   Margin="0,0,0,8"/>
                            <Label Text="Manage your restaurant details and system configuration" 
                                   FontSize="15" 
                                   TextColor="#64748B"
                                   HorizontalOptions="Center"/>
                        </StackLayout>
                    </Border>
                    
                    <!-- Logo Upload Section -->
                    <Border BackgroundColor="White" 
                            Padding="28"
                            Margin="0,0,0,20">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="20"/>
                        </Border.StrokeShape>
                        <Border.Shadow>
                            <Shadow Brush="#E5E7EB" Radius="20" Opacity="0.08" Offset="0,6"/>
                        </Border.Shadow>
                        <StackLayout>
                            
                            <!-- Logo Section Header -->
                            <Grid ColumnDefinitions="Auto,*,Auto" Margin="0,0,0,24">
                                <Border BackgroundColor="#8B5CF6"
                                        WidthRequest="36"
                                        HeightRequest="36"
                                        Grid.Column="0"
                                        VerticalOptions="Center">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="8"/>
                                    </Border.StrokeShape>
                                    <Border.Shadow>
                                        <Shadow Brush="#8B5CF6" Radius="8" Opacity="0.3" Offset="0,2"/>
                                    </Border.Shadow>
                                    <Label Text="ðŸª" 
                                           FontSize="16" 
                                           HorizontalOptions="Center"
                                           VerticalOptions="Center"/>
                                </Border>
                                <StackLayout Grid.Column="1" 
                                             VerticalOptions="Center"
                                             Margin="16,0,0,0">
                                    <Label Text="Restaurant Logo" 
                                           FontSize="20" 
                                           FontAttributes="Bold" 
                                           TextColor="#0F172A"/>
                                    <Label Text="Upload your restaurant logo to personalize your brand" 
                                           FontSize="14" 
                                           TextColor="#64748B"/>
                                </StackLayout>
                                <Button Text="Change Logo"
                                        Grid.Column="2"
                                        BackgroundColor="#8B5CF6"
                                        TextColor="White"
                                        FontSize="14"
                                        FontAttributes="Bold"
                                        CornerRadius="10"
                                        Padding="16,10"
                                        Clicked="OnChangeLogoClicked"
                                        VerticalOptions="Center">
                                    <Button.Shadow>
                                        <Shadow Brush="#8B5CF6" Radius="8" Opacity="0.3" Offset="0,2"/>
                                    </Button.Shadow>
                                </Button>
                            </Grid>
                            
                            <!-- Logo Display Area -->
                            <Grid ColumnDefinitions="Auto,*" ColumnSpacing="24">
                                
                                <!-- Current Logo Preview -->
                                <Border x:Name="LogoPreviewBorder"
                                        Grid.Column="0"
                                        WidthRequest="140"
                                        HeightRequest="140"
                                        BackgroundColor="#FAFBFC"
                                        Stroke="#E5E7EB"
                                        StrokeThickness="2"
                                        StrokeDashArray="8,4">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="16"/>
                                    </Border.StrokeShape>
                                    <Border.Shadow>
                                        <Shadow Brush="#E5E7EB" Radius="8" Opacity="0.1" Offset="0,2"/>
                                    </Border.Shadow>
                                    
                                    <!-- Default Logo Placeholder -->
                                    <Grid x:Name="LogoPlaceholder">
                                        <StackLayout HorizontalOptions="Center" VerticalOptions="Center" Spacing="8">
                                            <Border BackgroundColor="#F3F4F6"
                                                    WidthRequest="48"
                                                    HeightRequest="48">
                                                <Border.StrokeShape>
                                                    <RoundRectangle CornerRadius="12"/>
                                                </Border.StrokeShape>
                                                <Label Text="ðŸ“¸" 
                                                       FontSize="24" 
                                                       HorizontalOptions="Center"
                                                       VerticalOptions="Center"/>
                                            </Border>
                                            <Label Text="No Logo" 
                                                   FontSize="13" 
                                                   FontAttributes="Bold"
                                                   TextColor="#9CA3AF"
                                                   HorizontalOptions="Center"/>
                                            <Label Text="Click to upload" 
                                                   FontSize="11" 
                                                   TextColor="#D1D5DB"
                                                   HorizontalOptions="Center"/>
                                        </StackLayout>
                                    </Grid>
                                    
                                    <!-- Actual Logo Image (Initially Hidden) -->
                                    <Image x:Name="LogoImage"
                                           Aspect="AspectFit"
                                           IsVisible="False">
                                        <Image.Clip>
                                            <RoundRectangleGeometry Rect="0,0,140,140" CornerRadius="12"/>
                                        </Image.Clip>
                                    </Image>
                                </Border>
                                
                                <!-- Logo Upload Instructions -->
                                <StackLayout Grid.Column="1" 
                                             VerticalOptions="Center"
                                             Spacing="16">
                                    
                                    <!-- Upload Button -->
                                    <Button x:Name="UploadLogoButton"
                                            Text="ðŸ“ Choose Logo File"
                                            BackgroundColor="Transparent"
                                            TextColor="#3B82F6"
                                            FontSize="16"
                                            FontAttributes="Bold"
                                            BorderColor="#3B82F6"
                                            BorderWidth="2"
                                            CornerRadius="12"
                                            HeightRequest="48"
                                            Clicked="OnUploadLogoClicked"
                                            HorizontalOptions="Start"
                                            Padding="20,12">
                                        <Button.Shadow>
                                            <Shadow Brush="#3B82F6" Radius="8" Opacity="0.15" Offset="0,2"/>
                                        </Button.Shadow>
                                    </Button>
                                    
                                    <!-- Upload Guidelines -->
                                    <Border BackgroundColor="#F8F9FA"
                                            Stroke="#E5E7EB"
                                            StrokeThickness="1"
                                            Padding="16">
                                        <StackLayout Spacing="8">
                                            <Label Text="ðŸ“‹ Upload Guidelines" 
                                                   FontSize="14" 
                                                   FontAttributes="Bold"
                                                   TextColor="#374151"/>
                                            <Grid ColumnDefinitions="Auto,*" RowDefinitions="Auto,Auto,Auto,Auto" RowSpacing="4" ColumnSpacing="8">
                                                <Label Text="âœ“" FontSize="12" TextColor="#10B981" Grid.Row="0" Grid.Column="0" VerticalOptions="Center"/>
                                                <Label Text="Recommended size: 200x200 pixels or higher" FontSize="12" TextColor="#6B7280" Grid.Row="0" Grid.Column="1"/>
                                                
                                                <Label Text="âœ“" FontSize="12" TextColor="#10B981" Grid.Row="1" Grid.Column="0" VerticalOptions="Center"/>
                                                <Label Text="Supported formats: JPG, PNG, SVG" FontSize="12" TextColor="#6B7280" Grid.Row="1" Grid.Column="1"/>
                                                
                                                <Label Text="âœ“" FontSize="12" TextColor="#10B981" Grid.Row="2" Grid.Column="0" VerticalOptions="Center"/>
                                                <Label Text="Maximum file size: 5MB" FontSize="12" TextColor="#6B7280" Grid.Row="2" Grid.Column="1"/>
                                                
                                                <Label Text="âœ“" FontSize="12" TextColor="#10B981" Grid.Row="3" Grid.Column="0" VerticalOptions="Center"/>
                                                <Label Text="Square or circular logos work best" FontSize="12" TextColor="#6B7280" Grid.Row="3" Grid.Column="1"/>
                                            </Grid>
                                        </StackLayout>
                                    </Border>
                                    
                                    <!-- Logo Status and Actions -->
                                    <StackLayout Orientation="Horizontal" 
                                                 Spacing="12" 
                                                 Margin="0,0,0,0">
                                        <Button x:Name="RemoveLogoButton"
                                                Text="ðŸ—‘ï¸ Remove"
                                                BackgroundColor="Transparent"
                                                TextColor="#EF4444"
                                                FontSize="14"
                                                BorderColor="#EF4444"
                                                BorderWidth="1"
                                                CornerRadius="8"
                                                Padding="12,8"
                                                Clicked="OnRemoveLogoClicked"
                                                IsVisible="False"/>
                                        <Border BackgroundColor="#F0FDF4" 
                                                Stroke="#BBF7D0" 
                                                StrokeThickness="1"
                                                Padding="12,8"
                                                VerticalOptions="Center">
                                            <Label x:Name="LogoStatusLabel"
                                                   Text="Ready to upload"
                                                   FontSize="13"
                                                   FontAttributes="Bold"
                                                   TextColor="#16A34A"/>
                                        </Border>
                                    </StackLayout>
                                </StackLayout>
                            </Grid>
                        </StackLayout>
                    </Border>
                    
                    <!-- Main Business Info Card -->
                    <Border BackgroundColor="White" 
                            Padding="28">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="20"/>
                        </Border.StrokeShape>
                        <Border.Shadow>
                            <Shadow Brush="#E5E7EB" Radius="20" Opacity="0.08" Offset="0,6"/>
                        </Border.Shadow>
                        <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto" ColumnSpacing="24" RowSpacing="20">
                            
                            <!-- Column 1 -->
                            <Label Text="Restaurant Name" FontSize="16" FontAttributes="Bold" TextColor="#374151" Grid.Row="0" Grid.Column="0"/>
                            <Entry x:Name="RestaurantNameEntry" FontSize="16" BackgroundColor="#F9FAFB" TextColor="#1F2937" Grid.Row="1" Grid.Column="0"/>
                            
                            <Label Text="Phone Number" FontSize="16" FontAttributes="Bold" TextColor="#374151" Grid.Row="2" Grid.Column="0"/>
                            <Entry x:Name="PhoneEntry" FontSize="16" BackgroundColor="#F9FAFB" TextColor="#1F2937" Grid.Row="3" Grid.Column="0"/>
                            
                            <Label Text="Address" FontSize="16" FontAttributes="Bold" TextColor="#374151" Grid.Row="4" Grid.Column="0"/>
                            <Entry x:Name="AddressEntry" FontSize="16" BackgroundColor="#F9FAFB" TextColor="#1F2937" Grid.Row="5" Grid.Column="0"/>
                            
                            <Label Text="Postcode" FontSize="16" FontAttributes="Bold" TextColor="#374151" Grid.Row="6" Grid.Column="0"/>
                            <Entry x:Name="PostcodeEntry" FontSize="16" BackgroundColor="#F9FAFB" TextColor="#1F2937" Grid.Row="7" Grid.Column="0"/>
                            
                            <Label Text="VAT Number" FontSize="16" FontAttributes="Bold" TextColor="#374151" Grid.Row="8" Grid.Column="0"/>
                            <Entry x:Name="VATNumberEntry" FontSize="16" BackgroundColor="#F9FAFB" TextColor="#1F2937" Grid.Row="9" Grid.Column="0"/>
                            
                            <!-- Column 2 -->
                            <Label Text="Email" FontSize="16" FontAttributes="Bold" TextColor="#374151" Grid.Row="0" Grid.Column="1"/>
                            <Entry x:Name="EmailEntry" FontSize="16" BackgroundColor="#F9FAFB" TextColor="#1F2937" Grid.Row="1" Grid.Column="1"/>
                            
                            <Label Text="Website" FontSize="16" FontAttributes="Bold" TextColor="#374151" Grid.Row="2" Grid.Column="1"/>
                            <Entry x:Name="WebsiteEntry" FontSize="16" BackgroundColor="#F9FAFB" TextColor="#1F2937" Grid.Row="3" Grid.Column="1"/>
                            
                            <Label Text="City" FontSize="16" FontAttributes="Bold" TextColor="#374151" Grid.Row="4" Grid.Column="1"/>
                            <Entry x:Name="CityEntry" FontSize="16" BackgroundColor="#F9FAFB" TextColor="#1F2937" Grid.Row="5" Grid.Column="1"/>
                            
                            <Label Text="County" FontSize="16" FontAttributes="Bold" TextColor="#374151" Grid.Row="6" Grid.Column="1"/>
                            <Entry x:Name="CountyEntry" FontSize="16" BackgroundColor="#F9FAFB" TextColor="#1F2937" Grid.Row="7" Grid.Column="1"/>
                            
                            <Label Text="Country" FontSize="16" FontAttributes="Bold" TextColor="#374151" Grid.Row="8" Grid.Column="1"/>
                            <Entry x:Name="CountryEntry" FontSize="16" BackgroundColor="#F9FAFB" TextColor="#1F2937" Grid.Row="9" Grid.Column="1"/>
                            
                            <!-- Save Button -->
                            <Button Text="Save Business Info" 
                                    BackgroundColor="#10B981" 
                                    TextColor="White" 
                                    FontAttributes="Bold"
                                    FontSize="16"
                                    CornerRadius="12"
                                    HeightRequest="48"
                                    Padding="20,12"
                                    Clicked="OnSaveBusinessInfoClicked"
                                    Grid.Row="10" Grid.Column="0" Grid.ColumnSpan="2"
                                    Margin="0,20,0,0"/>
                        </Grid>
                    </Border>
                    
                </StackLayout>
                
                <!-- User Management Content -->
                <StackLayout x:Name="UserInfoContent" IsVisible="False" Padding="32,32,32,0">
                    
                    <!-- Enhanced Header -->
                    <Border BackgroundColor="White" 
                            Padding="0,32,0,28"
                            Margin="0,0,0,28">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="20"/>
                        </Border.StrokeShape>
                        <Border.Shadow>
                            <Shadow Brush="#E5E7EB" Radius="20" Opacity="0.08" Offset="0,6"/>
                        </Border.Shadow>
                        <StackLayout>
                            <!-- Modern icon for User Management -->
                            <Border BackgroundColor="#8B5CF6"
                                    WidthRequest="64"
                                    HeightRequest="64"
                                    HorizontalOptions="Center"
                                    Margin="0,0,0,16">
                                <Border.StrokeShape>
                                    <RoundRectangle CornerRadius="16"/>
                                </Border.StrokeShape>
                                <Border.Shadow>
                                    <Shadow Brush="#8B5CF6" Radius="16" Opacity="0.25" Offset="0,4"/>
                                </Border.Shadow>
                                <Label Text="UM" 
                                       FontSize="24" 
                                       FontAttributes="Bold" 
                                       TextColor="White"
                                       HorizontalOptions="Center"
                                       VerticalOptions="Center"/>
                            </Border>
                            <Label Text="User Management" 
                                   FontSize="28" 
                                   FontAttributes="Bold" 
                                   TextColor="#0F172A"
                                   HorizontalOptions="Center"
                                   Margin="0,0,0,8"/>
                            <Label Text="Manage user accounts, roles and permissions" 
                                   FontSize="15" 
                                   TextColor="#64748B"
                                   HorizontalOptions="Center"/>
                        </StackLayout>
                    </Border>
                    
                    <!-- Elegant Add New User Section -->
                    <Border BackgroundColor="White" 
                            Margin="0,0,0,24"
                            Stroke="#E1E7EF"
                            StrokeThickness="1">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="24"/>
                        </Border.StrokeShape>
                        <Border.Shadow>
                            <Shadow Brush="#000000" Radius="32" Opacity="0.04" Offset="0,8"/>
                        </Border.Shadow>
                        
                        <StackLayout Padding="32">
                            <!-- Section Header -->
                            <Grid ColumnDefinitions="Auto,*,Auto" Margin="0,0,0,28">
                                <Border BackgroundColor="#8B5CF6" 
                                        WidthRequest="48" 
                                        HeightRequest="48"
                                        Grid.Column="0"
                                        VerticalOptions="Center">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="14"/>
                                    </Border.StrokeShape>
                                    <Label Text="+" 
                                           FontSize="24" 
                                           FontAttributes="Bold" 
                                           TextColor="White"
                                           HorizontalOptions="Center"
                                           VerticalOptions="Center"/>
                                </Border>
                                
                                <StackLayout Grid.Column="1" Margin="16,0,0,0" VerticalOptions="Center">
                                    <Label Text="Add New Team Member" 
                                           FontSize="22" 
                                           FontAttributes="Bold" 
                                           TextColor="#0F172A"
                                           Margin="0,0,0,4"/>
                                    <Label Text="Create new user account with role and permissions" 
                                           FontSize="15" 
                                           TextColor="#64748B"/>
                                </StackLayout>
                            </Grid>
                            
                            <!-- Elegant Form Layout -->
                            <Grid RowDefinitions="Auto,Auto,Auto,Auto" RowSpacing="24">
                                
                                <!-- Row 1: Name and PIN -->
                                <Grid ColumnDefinitions="*,*" ColumnSpacing="20" Grid.Row="0">
                                    <!-- Name Field -->
                                    <StackLayout Grid.Column="0">
                                        <Label Text="Full Name" 
                                               FontSize="15" 
                                               FontAttributes="Bold"
                                               TextColor="#374151" 
                                               Margin="0,0,0,8"/>
                                        <Border BackgroundColor="#FAFBFC" 
                                                Stroke="#D1D5DB" 
                                                StrokeThickness="1.5"
                                                Padding="16,14">
                                            <Border.StrokeShape>
                                                <RoundRectangle CornerRadius="12"/>
                                            </Border.StrokeShape>
                                            <Entry x:Name="NameEntry" 
                                                   Placeholder="Enter full name" 
                                                   FontSize="16" 
                                                   TextColor="#1F2937"
                                                   BackgroundColor="Transparent"
                                                   PlaceholderColor="#9CA3AF"/>
                                        </Border>
                                    </StackLayout>
                                    
                                    <!-- PIN Field -->
                                    <StackLayout Grid.Column="1">
                                        <Label Text="Security PIN" 
                                               FontSize="15" 
                                               FontAttributes="Bold"
                                               TextColor="#374151" 
                                               Margin="0,0,0,8"/>
                                        <Border BackgroundColor="#FAFBFC" 
                                                Stroke="#D1D5DB" 
                                                StrokeThickness="1.5"
                                                Padding="16,14">
                                            <Border.StrokeShape>
                                                <RoundRectangle CornerRadius="12"/>
                                            </Border.StrokeShape>
                                            <Entry x:Name="PINEntry" 
                                                   Placeholder="Enter 4-digit PIN" 
                                                   FontSize="16" 
                                                   TextColor="#1F2937"
                                                   BackgroundColor="Transparent"
                                                   PlaceholderColor="#9CA3AF"
                                                   IsPassword="True" 
                                                   Keyboard="Numeric" 
                                                   MaxLength="4"/>
                                        </Border>
                                    </StackLayout>
                                </Grid>
                                
                                <!-- Row 2: Role Selection -->
                                <StackLayout Grid.Row="1">
                                    <Label Text="User Role and Permissions" 
                                           FontSize="15" 
                                           FontAttributes="Bold"
                                           TextColor="#374151" 
                                           Margin="0,0,0,8"/>
                                    <Border BackgroundColor="#FAFBFC" 
                                            Stroke="#D1D5DB" 
                                            StrokeThickness="1.5"
                                            Padding="0">
                                        <Border.StrokeShape>
                                            <RoundRectangle CornerRadius="12"/>
                                        </Border.StrokeShape>
                                        <Border BackgroundColor="Transparent"
                                                Padding="16,14">
                                            <Border.GestureRecognizers>
                                                <TapGestureRecognizer Tapped="OnSelectRoleClicked" />
                                            </Border.GestureRecognizers>
                                            <Grid ColumnDefinitions="*,Auto">
                                                <StackLayout Grid.Column="0" 
                                                             HorizontalOptions="StartAndExpand"
                                                             VerticalOptions="Center">
                                                    <Label x:Name="SelectedRoleLabel" 
                                                           Text="Choose user role" 
                                                           FontSize="16" 
                                                           TextColor="#6B7280"
                                                           HorizontalOptions="Start"/>
                                                </StackLayout>
                                                <Label Text="âŒ„" 
                                                       FontSize="18" 
                                                       TextColor="#9CA3AF"
                                                       Grid.Column="1"
                                                       VerticalOptions="Center"/>
                                            </Grid>
                                        </Border>
                                    </Border>
                                </StackLayout>
                                
                                <!-- Row 3: Action Button -->
                                <Grid Grid.Row="2" Margin="0,8,0,0">
                                    <Button Text="+ Add User" 
                                            BackgroundColor="#8B5CF6" 
                                            TextColor="White" 
                                            FontSize="16"
                                            FontAttributes="Bold"
                                            Padding="0,16"
                                            CornerRadius="12"
                                            Clicked="OnAddUserClicked"
                                            HorizontalOptions="End"
                                            WidthRequest="140">
                                        <Button.Shadow>
                                            <Shadow Brush="#8B5CF6" Radius="16" Opacity="0.3" Offset="0,4"/>
                                        </Button.Shadow>
                                    </Button>
                                </Grid>
                                
                            </Grid>
                        </StackLayout>
                    </Border>
                    
                    <!-- Elegant Current Users Section -->
                    <Border BackgroundColor="White" 
                            Stroke="#E1E7EF"
                            StrokeThickness="1">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="24"/>
                        </Border.StrokeShape>
                        <Border.Shadow>
                            <Shadow Brush="#000000" Radius="32" Opacity="0.04" Offset="0,8"/>
                        </Border.Shadow>
                        
                        <StackLayout Padding="32">
                            <!-- Section Header -->
                            <Grid ColumnDefinitions="Auto,*,Auto" Margin="0,0,0,28">
                                <Border BackgroundColor="#3B82F6" 
                                        WidthRequest="48" 
                                        HeightRequest="48"
                                        Grid.Column="0"
                                        VerticalOptions="Center">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="14"/>
                                    </Border.StrokeShape>
                                    <Label Text="TM" 
                                           FontSize="20" 
                                           TextColor="White"
                                           HorizontalOptions="Center"
                                           VerticalOptions="Center"/>
                                </Border>
                                
                                <StackLayout Grid.Column="1" Margin="16,0,0,0" VerticalOptions="Center">
                                    <Label Text="Team Members" 
                                           FontSize="22" 
                                           FontAttributes="Bold" 
                                           TextColor="#0F172A"
                                           Margin="0,0,0,4"/>
                                    <Label Text="Manage existing user accounts and permissions" 
                                           FontSize="15" 
                                           TextColor="#64748B"/>
                                </StackLayout>
                                
                                <!-- User Count Badge -->
                                <Border BackgroundColor="#F0F9FF" 
                                        Stroke="#3B82F6" 
                                        StrokeThickness="1"
                                        Padding="12,6"
                                        Grid.Column="2"
                                        VerticalOptions="Center">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="20"/>
                                    </Border.StrokeShape>
                                    <Label x:Name="UserCountLabel"
                                           Text="3 Users" 
                                           FontSize="14" 
                                           FontAttributes="Bold"
                                           TextColor="#1E40AF"/>
                                </Border>
                            </Grid>
                            
                            <!-- Users List with Enhanced Cards -->
                            <CollectionView x:Name="UsersCollectionView" 
                                            ItemsSource="{Binding Users}"
                                            ItemSizingStrategy="MeasureAllItems">
                                <CollectionView.ItemsLayout>
                                    <LinearItemsLayout Orientation="Vertical" ItemSpacing="16"/>
                                </CollectionView.ItemsLayout>
                                
                                <CollectionView.ItemTemplate>
                                    <DataTemplate>
                                        <Border BackgroundColor="#FAFBFC" 
                                                Stroke="#E5E7EB" 
                                                StrokeThickness="1"
                                                Padding="20">
                                            <Border.StrokeShape>
                                                <RoundRectangle CornerRadius="16"/>
                                            </Border.StrokeShape>
                                            
                                            <Grid ColumnDefinitions="Auto,*,Auto,Auto" ColumnSpacing="16">
                                                
                                                <!-- Enhanced User Avatar -->
                                                <Border Grid.Column="0" 
                                                        WidthRequest="56" 
                                                        HeightRequest="56"
                                                        VerticalOptions="Center">
                                                    <Border.StrokeShape>
                                                        <Ellipse/>
                                                    </Border.StrokeShape>
                                                    <Border.Background>
                                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                            <GradientStop Color="#8B5CF6" Offset="0"/>
                                                            <GradientStop Color="#3B82F6" Offset="1"/>
                                                        </LinearGradientBrush>
                                                    </Border.Background>
                                                    <Border.Shadow>
                                                        <Shadow Brush="#8B5CF6" Radius="12" Opacity="0.2" Offset="0,2"/>
                                                    </Border.Shadow>
                                                    
                                                    <Label Text="{Binding Name, Converter={StaticResource FirstLetterConverter}}" 
                                                           TextColor="White" 
                                                           FontSize="20" 
                                                           FontAttributes="Bold"
                                                           HorizontalOptions="Center" 
                                                           VerticalOptions="Center"/>
                                                </Border>
                                                
                                                <!-- User Information -->
                                                <StackLayout Grid.Column="1" 
                                                             VerticalOptions="Center"
                                                             Spacing="4">
                                                    <Label Text="{Binding Name}" 
                                                           FontSize="18" 
                                                           FontAttributes="Bold" 
                                                           TextColor="#0F172A"/>
                                                    
                                                    <Grid ColumnDefinitions="Auto,Auto,*" ColumnSpacing="12">
                                                        <!-- Role Badge -->
                                                        <Border BackgroundColor="#EEF2FF" 
                                                                Stroke="#A5B4FC" 
                                                                StrokeThickness="1"
                                                                Padding="8,4"
                                                                Grid.Column="0">
                                                            <Border.StrokeShape>
                                                                <RoundRectangle CornerRadius="8"/>
                                                            </Border.StrokeShape>
                                                            <Label Text="{Binding Role}" 
                                                                   FontSize="13" 
                                                                   FontAttributes="Bold"
                                                                   TextColor="#4F46E5"/>
                                                        </Border>
                                                        
                                                        <!-- Status Indicator -->
                                                        <Border BackgroundColor="#F0FDF4" 
                                                                Stroke="#BBF7D0" 
                                                                StrokeThickness="1"
                                                                Padding="8,4"
                                                                Grid.Column="1">
                                                            <Border.StrokeShape>
                                                                <RoundRectangle CornerRadius="8"/>
                                                            </Border.StrokeShape>
                                                            <Grid ColumnDefinitions="Auto,Auto" ColumnSpacing="6">
                                                                <Ellipse Fill="#22C55E" 
                                                                         WidthRequest="8" 
                                                                         HeightRequest="8"
                                                                         Grid.Column="0"
                                                                         VerticalOptions="Center"/>
                                                                <Label Text="Active" 
                                                                       FontSize="13" 
                                                                       FontAttributes="Bold"
                                                                       TextColor="#15803D"
                                                                       Grid.Column="1"/>
                                                            </Grid>
                                                        </Border>
                                                    </Grid>
                                                </StackLayout>
                                                
                                                <!-- Action Buttons -->
                                                <StackLayout Orientation="Horizontal" 
                                                             Grid.Column="2"
                                                             Spacing="8"
                                                             VerticalOptions="Center">
                                                    
                                                    <!-- Edit Button -->
                                                    <Button Text="Edit" 
                                                            BackgroundColor="#3B82F6" 
                                                            TextColor="White"
                                                            FontSize="14"
                                                            FontAttributes="Bold"
                                                            Padding="16,10"
                                                            CornerRadius="10"
                                                            WidthRequest="80"
                                                            Clicked="OnEditUserClicked"
                                                            CommandParameter="{Binding}">
                                                        <Button.Shadow>
                                                            <Shadow Brush="#3B82F6" Radius="8" Opacity="0.2" Offset="0,2"/>
                                                        </Button.Shadow>
                                                    </Button>
                                                    
                                                    <!-- Delete Button -->
                                                    <Button Text="Delete" 
                                                            BackgroundColor="#EF4444" 
                                                            TextColor="White"
                                                            FontSize="14"
                                                            FontAttributes="Bold"
                                                            Padding="16,10"
                                                            CornerRadius="10"
                                                            WidthRequest="80"
                                                            Clicked="OnDeleteUserClicked"
                                                            CommandParameter="{Binding}">
                                                        <Button.Shadow>
                                                            <Shadow Brush="#EF4444" Radius="8" Opacity="0.2" Offset="0,2"/>
                                                        </Button.Shadow>
                                                    </Button>
                                                    
                                                </StackLayout>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </CollectionView.ItemTemplate>
                                
                                <!-- Empty State -->
                                <CollectionView.EmptyView>
                                    <StackLayout HorizontalOptions="Center" 
                                                 VerticalOptions="Center"
                                                 Padding="40">
                                        <Border BackgroundColor="#F3F4F6" 
                                                WidthRequest="80" 
                                                HeightRequest="80"
                                                HorizontalOptions="Center"
                                                Margin="0,0,0,16">
                                            <Border.StrokeShape>
                                                <Ellipse/>
                                            </Border.StrokeShape>
                                            <Label Text="TM" 
                                                   FontSize="32" 
                                                   HorizontalOptions="Center"
                                                   VerticalOptions="Center"/>
                                        </Border>
                                        <Label Text="No team members yet" 
                                               FontSize="18" 
                                               FontAttributes="Bold" 
                                               TextColor="#6B7280"
                                               HorizontalOptions="Center"
                                               Margin="0,0,0,8"/>
                                        <Label Text="Add your first team member to get started" 
                                               FontSize="15" 
                                               TextColor="#9CA3AF"
                                               HorizontalOptions="Center"/>
                                    </StackLayout>
                                </CollectionView.EmptyView>
                            </CollectionView>
                        </StackLayout>
                    </Border>
                    
                </StackLayout>
                
                <!-- OrderWeb Content with Expandable Sections -->
                <StackLayout x:Name="OrderWebContent" IsVisible="False" Padding="32,32,32,0">
                    
                    <!-- Enhanced Header -->
                    <Border BackgroundColor="White" 
                            Padding="0,32,0,28"
                            Margin="0,0,0,28">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="20"/>
                        </Border.StrokeShape>
                        <Border.Shadow>
                            <Shadow Brush="#E5E7EB" Radius="20" Opacity="0.08" Offset="0,6"/>
                        </Border.Shadow>
                        <StackLayout>
                            <!-- Modern icon for OrderWeb -->
                            <Border BackgroundColor="#10B981"
                                    WidthRequest="64"
                                    HeightRequest="64"
                                    HorizontalOptions="Center"
                                    Margin="0,0,0,16">
                                <Border.StrokeShape>
                                    <RoundRectangle CornerRadius="16"/>
                                </Border.StrokeShape>
                                <Border.Shadow>
                                    <Shadow Brush="#10B981" Radius="16" Opacity="0.25" Offset="0,4"/>
                                </Border.Shadow>
                                <Label Text="OW" 
                                       FontSize="24" 
                                       FontAttributes="Bold" 
                                       TextColor="White"
                                       HorizontalOptions="Center"
                                       VerticalOptions="Center"/>
                            </Border>
                            <Label Text="OrderWeb Settings" 
                                   FontSize="28" 
                                   FontAttributes="Bold" 
                                   TextColor="#0F172A"
                                   HorizontalOptions="Center"
                                   Margin="0,0,0,8"/>
                            <Label Text="Configure postcode lookup and cloud connectivity" 
                                   FontSize="15" 
                                   TextColor="#64748B"
                                   HorizontalOptions="Center"/>
                        </StackLayout>
                    </Border>
                    
                    <!-- Postcode Lookup Section -->
                    <Border BackgroundColor="White" 
                            Padding="0"
                            Margin="0,0,0,20">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="20"/>
                        </Border.StrokeShape>
                        <Border.Shadow>
                            <Shadow Brush="#E5E7EB" Radius="20" Opacity="0.08" Offset="0,6"/>
                        </Border.Shadow>
                        <StackLayout>
                            
                            <!-- Postcode Section Header (Clickable) -->
                            <Border BackgroundColor="#F8FAFC" 
                                    Padding="28,20">
                                <Border.GestureRecognizers>
                                    <TapGestureRecognizer Tapped="OnPostcodeSectionToggled"/>
                                </Border.GestureRecognizers>
                                <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="16">
                                    <Border BackgroundColor="#3B82F6" 
                                            WidthRequest="4" 
                                            HeightRequest="24" 
                                            Grid.Column="0" 
                                            VerticalOptions="Center">
                                        <Border.StrokeShape>
                                            <RoundRectangle CornerRadius="2" />
                                        </Border.StrokeShape>
                                    </Border>
                                    <Label Text="Postcode Lookup Settings" 
                                           FontSize="20" 
                                           FontAttributes="Bold" 
                                           TextColor="#1E293B"
                                           Grid.Column="1"
                                           VerticalOptions="Center"/>
                                    <Label x:Name="PostcodeToggleIcon" 
                                           Text="â–¼" 
                                           FontSize="16" 
                                           TextColor="#64748B"
                                           Grid.Column="2"
                                           VerticalOptions="Center"/>
                                </Grid>
                            </Border>
                            
                            <!-- Postcode Content (Expandable) -->
                            <StackLayout x:Name="PostcodeContent" Padding="28" IsVisible="True">
                                
                                <!-- Mapbox Token Section -->
                                <StackLayout>
                                    <Label Text="Mapbox API Token" FontSize="14" FontAttributes="Bold" TextColor="#374151" Margin="0,0,0,8"/>
                                    <Grid ColumnDefinitions="*,Auto,Auto" ColumnSpacing="12">
                                        <Border Grid.Column="0" StrokeThickness="1" Stroke="#D1D5DB" BackgroundColor="#FFFFFF">
                                            <Border.StrokeShape>
                                                <RoundRectangle CornerRadius="8" />
                                            </Border.StrokeShape>
                                            <Entry x:Name="OrderWebMapboxTokenEntry"
                                                   Placeholder="Enter Mapbox API token"
                                                   FontSize="14"
                                                   TextColor="#1F2937"
                                                   PlaceholderColor="#9CA3AF"
                                                   IsPassword="True"
                                                   Margin="12,8" />
                                        </Border>
                                        <Button x:Name="ToggleOrderWebMapboxTokenButton"
                                                Text="Show"
                                                BackgroundColor="#6B7280"
                                                TextColor="White"
                                                FontSize="12"
                                                WidthRequest="50"
                                                HeightRequest="40"
                                                CornerRadius="6"
                                                Clicked="OnToggleOrderWebMapboxTokenClicked"
                                                Grid.Column="1"/>
                                        <Button x:Name="TestOrderWebMapboxButton"
                                                Text="Test"
                                                BackgroundColor="#3B82F6"
                                                TextColor="White"
                                                FontAttributes="Bold"
                                                Clicked="OnTestOrderWebMapboxClicked"
                                                Grid.Column="2"/>
                                    </Grid>
                                </StackLayout>
                                
                                <!-- Status Frame -->
                                <Border x:Name="OrderWebMapboxStatusFrame"
                                        BackgroundColor="#FEF3C7"
                                        Stroke="#F59E0B"
                                        StrokeThickness="1"
                                        Padding="16"
                                        Margin="0,16,0,0"
                                        IsVisible="False">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="12"/>
                                    </Border.StrokeShape>
                                    <StackLayout>
                                        <HorizontalStackLayout Spacing="12">
                                            <Border BackgroundColor="#F59E0B" 
                                                    WidthRequest="6" 
                                                    HeightRequest="6" 
                                                    VerticalOptions="Center">
                                                <Border.StrokeShape>
                                                    <Ellipse />
                                                </Border.StrokeShape>
                                            </Border>
                                            <Label x:Name="OrderWebMapboxStatusText" 
                                                   Text="Testing connection..." 
                                                   FontSize="14" 
                                                   FontAttributes="Bold"
                                                   TextColor="#92400E"/>
                                        </HorizontalStackLayout>
                                    </StackLayout>
                                </Border>
                                
                                <!-- Save Button -->
                                <Button x:Name="SaveOrderWebPostcodeButton"
                                        Text="Save Settings"
                                        BackgroundColor="#10B981"
                                        TextColor="White"
                                        FontAttributes="Bold"
                                        FontSize="14"
                                        HeightRequest="44"
                                        CornerRadius="8"
                                        Clicked="OnSaveOrderWebPostcodeClicked"
                                        Margin="0,20,0,0"/>
                                
                                <!-- Usage Statistics -->
                                <Border x:Name="OrderWebMapboxStatsFrame"
                                        BackgroundColor="#F0F9FF"
                                        Stroke="#0EA5E9"
                                        StrokeThickness="1"
                                        Padding="16"
                                        Margin="0,20,0,0">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="12"/>
                                    </Border.StrokeShape>
                                    <StackLayout>
                                        <Label Text="Usage Statistics" FontSize="16" FontAttributes="Bold" TextColor="#0C4A6E" Margin="0,0,0,8"/>
                                        <Label x:Name="OrderWebMapboxUsageLabel" Text="API Calls This Month: Loading..." FontSize="14" TextColor="#075985"/>
                                        <Label x:Name="OrderWebMapboxLastUsedLabel" Text="Last Used: Never" FontSize="14" TextColor="#075985"/>
                                    </StackLayout>
                                </Border>
                                
                            </StackLayout>
                        </StackLayout>
                    </Border>
                    
                    <!-- Cloud Connect Section -->
                    <Border BackgroundColor="White" 
                            Padding="0"
                            Margin="0,0,0,20">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="20"/>
                        </Border.StrokeShape>
                        <Border.Shadow>
                            <Shadow Brush="#E5E7EB" Radius="20" Opacity="0.08" Offset="0,6"/>
                        </Border.Shadow>
                        <StackLayout>
                            
                            <!-- Cloud Section Header (Clickable) -->
                            <Border BackgroundColor="#F8FAFC" 
                                    Padding="28,20">
                                <Border.GestureRecognizers>
                                    <TapGestureRecognizer Tapped="OnCloudSectionToggled"/>
                                </Border.GestureRecognizers>
                                <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="16">
                                    <Border BackgroundColor="#8B5CF6" 
                                            WidthRequest="4" 
                                            HeightRequest="24" 
                                            Grid.Column="0" 
                                            VerticalOptions="Center">
                                        <Border.StrokeShape>
                                            <RoundRectangle CornerRadius="2" />
                                        </Border.StrokeShape>
                                    </Border>
                                    <Label Text="Cloud Connect Settings" 
                                           FontSize="20" 
                                           FontAttributes="Bold" 
                                           TextColor="#1E293B"
                                           Grid.Column="1"
                                           VerticalOptions="Center"/>
                                    <Label x:Name="CloudToggleIcon" 
                                           Text="â–¶" 
                                           FontSize="16" 
                                           TextColor="#64748B"
                                           Grid.Column="2"
                                           VerticalOptions="Center"/>
                                </Grid>
                            </Border>
                            
                            <!-- Cloud Content (Expandable) -->
                            <StackLayout x:Name="CloudContent" Padding="28" IsVisible="False">
                                
                                <!-- OrderWeb Connect Configuration -->
                                <Label Text="OrderWeb Connect Configuration" FontSize="18" FontAttributes="Bold" TextColor="#1E293B" Margin="0,0,0,16"/>
                                
                                <!-- Connection Settings Grid -->
                                <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto" ColumnSpacing="24" RowSpacing="20">
                                    
                                    <!-- Column 1 -->
                                    <Label Text="Tenant Slug" FontSize="14" FontAttributes="Bold" TextColor="#374151" Grid.Row="0" Grid.Column="0"/>
                                    <Border Grid.Row="1" Grid.Column="0" StrokeThickness="1" Stroke="#D1D5DB" BackgroundColor="#FFFFFF">
                                        <Border.StrokeShape>
                                            <RoundRectangle CornerRadius="8" />
                                        </Border.StrokeShape>
                                        <Entry x:Name="TenantSlugEntry" 
                                               Placeholder="your-restaurant-slug"
                                               FontSize="14" 
                                               TextColor="#1F2937" 
                                               PlaceholderColor="#9CA3AF"
                                               Margin="12,8" />
                                    </Border>
                                    
                                    <Label Text="API Key" FontSize="14" FontAttributes="Bold" TextColor="#374151" Grid.Row="2" Grid.Column="0"/>
                                    <Grid Grid.Row="3" Grid.Column="0" ColumnDefinitions="*,Auto" ColumnSpacing="8">
                                        <Border Grid.Column="0" StrokeThickness="1" Stroke="#D1D5DB" BackgroundColor="#FFFFFF">
                                            <Border.StrokeShape>
                                                <RoundRectangle CornerRadius="8" />
                                            </Border.StrokeShape>
                                            <Entry x:Name="CloudApiKeyEntry"
                                                   Placeholder="Enter API key"
                                                   FontSize="14"
                                                   TextColor="#1F2937"
                                                   PlaceholderColor="#9CA3AF"
                                                   IsPassword="True"
                                                   Margin="12,8" />
                                        </Border>
                                        <Button x:Name="ToggleCloudApiKeyButton"
                                                Text="Show"
                                                BackgroundColor="#6B7280"
                                                TextColor="White"
                                                FontSize="12"
                                                WidthRequest="50"
                                                HeightRequest="40"
                                                CornerRadius="6"
                                                Clicked="OnToggleCloudApiKeyClicked"
                                                Grid.Column="1"/>
                                    </Grid>
                                    
                                    <Label Text="REST API URL" FontSize="14" FontAttributes="Bold" TextColor="#374151" Grid.Row="4" Grid.Column="0"/>
                                    <Border Grid.Row="5" Grid.Column="0" StrokeThickness="1" Stroke="#D1D5DB" BackgroundColor="#FFFFFF">
                                        <Border.StrokeShape>
                                            <RoundRectangle CornerRadius="8" />
                                        </Border.StrokeShape>
                                        <Entry x:Name="CloudRestApiUrlEntry"
                                               Placeholder="https://api.orderweb.co.uk"
                                               FontSize="14"
                                               TextColor="#1F2937"
                                               PlaceholderColor="#9CA3AF"
                                               Margin="12,8" />
                                    </Border>
                                    
                                    <!-- Column 2 -->
                                    <Label Text="WebSocket URL" FontSize="14" FontAttributes="Bold" TextColor="#374151" Grid.Row="0" Grid.Column="1"/>
                                    <Border Grid.Row="1" Grid.Column="1" StrokeThickness="1" Stroke="#D1D5DB" BackgroundColor="#FFFFFF">
                                        <Border.StrokeShape>
                                            <RoundRectangle CornerRadius="8" />
                                        </Border.StrokeShape>
                                        <Entry x:Name="CloudWebSocketUrlEntry"
                                               Placeholder="wss://ws.orderweb.co.uk"
                                               FontSize="14"
                                               TextColor="#1F2937"
                                               PlaceholderColor="#9CA3AF"
                                               Margin="12,8" />
                                    </Border>
                                    
                                    <!-- Connection Actions -->
                                    <HorizontalStackLayout Grid.Row="6" Grid.Column="0" Grid.ColumnSpan="2" Spacing="12" Margin="0,24,0,0">
                                        <Button x:Name="CloudConnectButton"
                                                Text="Connect"
                                                BackgroundColor="#3B82F6"
                                                TextColor="White"
                                                FontAttributes="Bold"
                                                FontSize="14"
                                                HeightRequest="44"
                                                CornerRadius="8"
                                                Clicked="OnCloudConnectClicked"/>
                                        <Button x:Name="CloudSyncOrdersButton"
                                                Text="Sync Orders"
                                                BackgroundColor="#10B981"
                                                TextColor="White"
                                                FontAttributes="Bold"
                                                FontSize="14"
                                                HeightRequest="44"
                                                CornerRadius="8"
                                                Clicked="OnCloudSyncOrdersClicked"/>
                                        <Button x:Name="CloudSyncHistoricalButton"
                                                Text="Sync Historical"
                                                BackgroundColor="#8B5CF6"
                                                TextColor="White"
                                                FontAttributes="Bold"
                                                FontSize="14"
                                                HeightRequest="44"
                                                CornerRadius="8"
                                                Clicked="OnCloudSyncHistoricalClicked"/>
                                    </HorizontalStackLayout>
                                    
                                </Grid>
                                
                                <!-- Connection Status -->
                                <Border x:Name="CloudConnectionStatusFrame"
                                        BackgroundColor="#FEF3C7"
                                        Stroke="#F59E0B"
                                        StrokeThickness="1"
                                        Padding="20"
                                        Margin="0,24,0,0">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="12"/>
                                    </Border.StrokeShape>
                                    <StackLayout>
                                        <HorizontalStackLayout Spacing="12" Margin="0,0,0,8">
                                            <Border BackgroundColor="#F59E0B" 
                                                    WidthRequest="8" 
                                                    HeightRequest="8" 
                                                    VerticalOptions="Center">
                                                <Border.StrokeShape>
                                                    <Ellipse />
                                                </Border.StrokeShape>
                                            </Border>
                                            <StackLayout VerticalOptions="Center">
                                                <Label x:Name="CloudConnectionStatusText" 
                                                       Text="Not Connected" 
                                                       FontSize="16" 
                                                       FontAttributes="Bold"
                                                       TextColor="#92400E"/>
                                                <Label x:Name="CloudConnectionStatusDescription"
                                                       Text="Configure your connection settings to get started"
                                                       FontSize="14"
                                                       TextColor="#B45309"/>
                                            </StackLayout>
                                        </HorizontalStackLayout>
                                    </StackLayout>
                                </Border>
                                
                                <!-- System Status Section -->
                                <StackLayout x:Name="CloudSystemStatusSection" IsVisible="False" Margin="0,24,0,0">
                                    <Label Text="ðŸ“Š System Status" FontSize="18" FontAttributes="Bold" TextColor="#1E293B" Margin="0,0,0,16"/>
                                    
                                    <Grid ColumnDefinitions="*,*" ColumnSpacing="20">
                                        
                                        <!-- Connection Status -->
                                        <Border BackgroundColor="#F0FDF4" 
                                                Stroke="#16A34A" 
                                                StrokeThickness="1" 
                                                Padding="16"
                                                Grid.Column="0">
                                            <Border.StrokeShape>
                                                <RoundRectangle CornerRadius="12"/>
                                            </Border.StrokeShape>
                                            <StackLayout>
                                                <HorizontalStackLayout Spacing="8">
                                                    <Label x:Name="CloudStatusConnectionIcon" Text="ðŸŸ¢" FontSize="18"/>
                                                    <Label x:Name="CloudStatusConnectionText" 
                                                           Text="Connected" 
                                                           FontSize="16" 
                                                           FontAttributes="Bold"
                                                           TextColor="#15803D"/>
                                                </HorizontalStackLayout>
                                                <Label Text="Real-time sync active" FontSize="14" TextColor="#166534" Margin="26,4,0,0"/>
                                            </StackLayout>
                                        </Border>
                                        
                                        <!-- Backup Status -->
                                        <Border BackgroundColor="#F0F9FF" 
                                                Stroke="#0EA5E9" 
                                                StrokeThickness="1" 
                                                Padding="16"
                                                Grid.Column="1">
                                            <Border.StrokeShape>
                                                <RoundRectangle CornerRadius="12"/>
                                            </Border.StrokeShape>
                                            <StackLayout>
                                                <HorizontalStackLayout Spacing="8">
                                                    <Label x:Name="CloudStatusBackupIcon" Text="ðŸ’¾" FontSize="18"/>
                                                    <Label x:Name="CloudStatusBackupText" 
                                                           Text="Backup Active" 
                                                           FontSize="16" 
                                                           FontAttributes="Bold"
                                                           TextColor="#0C4A6E"/>
                                                </HorizontalStackLayout>
                                                <Label x:Name="CloudStatusLastCheckText" 
                                                       Text="Last backup: 2 minutes ago" 
                                                       FontSize="14" 
                                                       TextColor="#075985" 
                                                       Margin="26,4,0,0"/>
                                            </StackLayout>
                                        </Border>
                                        
                                    </Grid>
                                    
                                    <!-- Device Information -->
                                    <Label x:Name="CloudDeviceInfoText" 
                                           Text="Device ID: POS-ABC123 | Location: Main Terminal" 
                                           FontSize="14" 
                                           TextColor="#6B7280"
                                           HorizontalOptions="Center"
                                           Margin="0,16,0,0"/>
                                    
                                </StackLayout>
                                
                            </StackLayout>
                        </StackLayout>
                    </Border>
                    
                </StackLayout>
                
            </StackLayout>
        </ScrollView>
        
        <!-- Edit User Overlay -->
        <views:EditUserOverlay x:Name="EditUserOverlay" 
                               Grid.Row="0" 
                               Grid.RowSpan="4" 
                               IsVisible="False" />
        
        <!-- Role Selection Overlay - Must be last to appear on top -->
        <views:RoleSelectionOverlay x:Name="RoleSelectionOverlay" 
                                    Grid.Row="0" 
                                    Grid.RowSpan="4" 
                                    IsVisible="False" />
        
    </Grid>
</ContentPage>