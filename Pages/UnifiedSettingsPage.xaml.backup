<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:controls="clr-namespace:POS_in_NET.Controls"
             xmlns:views="clr-namespace:POS_in_NET.Views"
             x:Class="POS_in_NET.Pages.UnifiedSettingsPage"
             Title="Settings"
             BackgroundColor="#F8F9FA">

    <Grid RowDefinitions="Auto,Auto,Auto,*" RowSpacing="0">
        
        <!-- Top Navigation Bar -->
        <views:TopBar x:Name="TopBar" Grid.Row="0"/>
        
        <!-- Loading Indicator -->
        <Grid x:Name="LoadingIndicator" Grid.Row="0" Grid.RowSpan="4" 
              IsVisible="False" 
              BackgroundColor="#80000000">
            <ActivityIndicator IsRunning="True" Color="White" />
        </Grid>
        
        <!-- Toast Notification -->
        <controls:ToastNotification x:Name="ToastNotification" 
                                    Grid.Row="1"
                                    IsVisible="False" />
        
        <!-- Modern Enhanced Tab Bar -->
        <Border Grid.Row="2" 
                BackgroundColor="#FAFBFF"
                Padding="0,30,0,30"
                Stroke="#E2E8F0"
                StrokeThickness="1"
                HeightRequest="120">
            <Border.Shadow>
                <Shadow Brush="#CBD5E1" Radius="16" Opacity="0.12" Offset="0,6"/>
            </Border.Shadow>
            
            <ScrollView Orientation="Horizontal" HorizontalScrollBarVisibility="Never" Padding="32,0">
                <HorizontalStackLayout Spacing="24" HorizontalOptions="Center">
                    
                    <!-- Business Info Tab -->
                    <Border x:Name="BusinessTabBorder"
                            BackgroundColor="#3B82F6"
                            StrokeThickness="0"
                            Padding="36,20"
                            MinimumWidthRequest="180"
                            HeightRequest="60">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="15"/>
                        </Border.StrokeShape>
                        <Border.Shadow>
                            <Shadow Brush="#3B82F6" Radius="20" Opacity="0.3" Offset="0,6"/>
                        </Border.Shadow>
                        <Border.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnBusinessTabClicked"/>
                        </Border.GestureRecognizers>
                        <Label Text="Business Info" 
                               FontFamily="InterSemiBold" 
                               FontSize="16" 
                               TextColor="White" 
                               HorizontalOptions="Center" 
                               VerticalOptions="Center"/>
                    </Border>

                    <!-- User Management Tab -->
                    <Border x:Name="UserTabBorder"
                            BackgroundColor="White"
                            Stroke="#E2E8F0"
                            StrokeThickness="2"
                            Padding="36,20"
                            MinimumWidthRequest="180"
                            HeightRequest="60">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="15"/>
                        </Border.StrokeShape>
                        <Border.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnUserTabClicked"/>
                        </Border.GestureRecognizers>
                        <Label Text="User Management" 
                               FontFamily="InterMedium" 
                               FontSize="16" 
                               TextColor="#6B7280" 
                               HorizontalOptions="Center" 
                               VerticalOptions="Center"/>
                    </Border>

                    <!-- OrderWeb Tab -->
                    <Border x:Name="OrderWebTabBorder"
                            BackgroundColor="White"
                            Stroke="#E2E8F0"
                            StrokeThickness="2"
                            Padding="36,20"
                            MinimumWidthRequest="180"
                            HeightRequest="60">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="15"/>
                        </Border.StrokeShape>
                        <Border.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnOrderWebTabClicked"/>
                        </Border.GestureRecognizers>
                        <Label Text="OrderWeb" 
                               FontFamily="InterMedium" 
                               FontSize="16" 
                               TextColor="#6B7280" 
                               HorizontalOptions="Center" 
                               VerticalOptions="Center"/>
                    </Border>

                    <!-- Cloud Connect Tab -->
                    <Border x:Name="CloudTabBorder"
                            BackgroundColor="White"
                            Stroke="#E2E8F0"
                            StrokeThickness="2"
                            Padding="36,20"
                            MinimumWidthRequest="180"
                            HeightRequest="60">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="15"/>
                        </Border.StrokeShape>
                        <Border.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnCloudTabClicked"/>
                        </Border.GestureRecognizers>
                        <Label Text="Cloud Connect" 
                               FontFamily="InterMedium" 
                               FontSize="16" 
                               TextColor="#6B7280" 
                               HorizontalOptions="Center" 
                               VerticalOptions="Center"/>
                    </Border>

                    <!-- Postcode Lookup Tab -->
                    <Border x:Name="PostcodeTabBorder"
                            BackgroundColor="White"
                            Stroke="#E2E8F0"
                            StrokeThickness="2"
                            Padding="36,20"
                            MinimumWidthRequest="180"
                            HeightRequest="60">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="15"/>
                        </Border.StrokeShape>
                        <Border.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnPostcodeTabClicked"/>
                        </Border.GestureRecognizers>
                        <Label Text="Postcode Lookup" 
                               FontFamily="InterMedium" 
                               FontSize="16" 
                               TextColor="#6B7280" 
                               HorizontalOptions="Center" 
                               VerticalOptions="Center"/>
                    </Border>

                </HorizontalStackLayout>
            </ScrollView>
        </Border>
        
        <!-- Content Area -->
        <ScrollView Grid.Row="3" Padding="40" BackgroundColor="White" Margin="20" MinimumHeightRequest="400">
            <StackLayout>
                <!-- Business Info Content -->
                <StackLayout x:Name="BusinessInfoContent" IsVisible="True" Spacing="30" Padding="20">
                    <Label Text="Business Information" 
                           FontFamily="InterBold" 
                           FontSize="28" 
                           TextColor="#111827" 
                           HorizontalOptions="Center"/>

                    <!-- Restaurant Name -->
                    <StackLayout Spacing="10">
                        <Label Text="Restaurant Name" FontFamily="InterSemiBold" FontSize="16" TextColor="#374151"/>
                        <Entry x:Name="RestaurantNameEntry" 
                               Placeholder="Enter restaurant name"
                               FontFamily="InterRegular"
                               FontSize="16"
                               HeightRequest="50"/>
                    </StackLayout>

                    <!-- Contact Information -->
                    <StackLayout Spacing="10">
                        <Label Text="Phone Number" FontFamily="InterSemiBold" FontSize="16" TextColor="#374151"/>
                        <Entry x:Name="PhoneEntry" 
                               Placeholder="Enter phone number"
                               FontFamily="InterRegular"
                               FontSize="16"
                               HeightRequest="50"/>
                    </StackLayout>

                    <StackLayout Spacing="10">
                        <Label Text="Email Address" FontFamily="InterSemiBold" FontSize="16" TextColor="#374151"/>
                        <Entry x:Name="EmailEntry" 
                               Placeholder="Enter email address"
                               FontFamily="InterRegular"
                               FontSize="16"
                               HeightRequest="50"/>
                    </StackLayout>

                    <!-- Address Information -->
                    <StackLayout Spacing="10">
                        <Label Text="Building Name/Number" FontFamily="InterSemiBold" FontSize="16" TextColor="#374151"/>
                        <Entry x:Name="BuildingNameEntry" 
                               Placeholder="Enter building name or number"
                               FontFamily="InterRegular"
                               FontSize="16"
                               HeightRequest="50"/>
                    </StackLayout>

                    <StackLayout Spacing="10">
                        <Label Text="Road Name" FontFamily="InterSemiBold" FontSize="16" TextColor="#374151"/>
                        <Entry x:Name="RoadNameEntry" 
                               Placeholder="Enter road name"
                               FontFamily="InterRegular"
                               FontSize="16"
                               HeightRequest="50"/>
                    </StackLayout>

                    <StackLayout Spacing="10">
                        <Label Text="City" FontFamily="InterSemiBold" FontSize="16" TextColor="#374151"/>
                        <Entry x:Name="CityEntry" 
                               Placeholder="Enter city"
                               FontFamily="InterRegular"
                               FontSize="16"
                               HeightRequest="50"/>
                    </StackLayout>

                    <StackLayout Spacing="10">
                        <Label Text="Post Code" FontFamily="InterSemiBold" FontSize="16" TextColor="#374151"/>
                        <Entry x:Name="PostCodeEntry" 
                               Placeholder="Enter post code"
                               FontFamily="InterRegular"
                               FontSize="16"
                               HeightRequest="50"/>
                    </StackLayout>

                    <StackLayout Spacing="10">
                        <Label Text="Country" FontFamily="InterSemiBold" FontSize="16" TextColor="#374151"/>
                        <Entry x:Name="CountryEntry" 
                               Placeholder="Enter country"
                               FontFamily="InterRegular"
                               FontSize="16"
                               HeightRequest="50"/>
                    </StackLayout>

                    <!-- VAT Information -->
                    <StackLayout Spacing="10">
                        <Label Text="VAT Number" FontFamily="InterSemiBold" FontSize="16" TextColor="#374151"/>
                        <Entry x:Name="VatNumberEntry" 
                               Placeholder="Enter VAT number"
                               FontFamily="InterRegular"
                               FontSize="16"
                               HeightRequest="50"/>
                    </StackLayout>

                    <!-- Logo Section -->
                    <StackLayout Spacing="15">
                        <Label Text="Restaurant Logo" FontFamily="InterSemiBold" FontSize="16" TextColor="#374151"/>
                        
                        <Border BackgroundColor="#F3F4F6" 
                                StrokeThickness="2" 
                                Stroke="#D1D5DB" 
                                HeightRequest="200" 
                                WidthRequest="200" 
                                HorizontalOptions="Center">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="10"/>
                            </Border.StrokeShape>
                            
                            <Grid>
                                <Image x:Name="LogoImage" 
                                       IsVisible="False"
                                       Aspect="AspectFill"/>
                                
                                <Label x:Name="LogoPlaceholder" 
                                       Text="No Logo Selected" 
                                       FontFamily="InterRegular" 
                                       FontSize="14" 
                                       TextColor="#6B7280" 
                                       HorizontalOptions="Center" 
                                       VerticalOptions="Center"/>
                            </Grid>
                        </Border>
                        
                        <Label x:Name="LogoFileName" 
                               Text="No file chosen" 
                               FontFamily="InterRegular" 
                               FontSize="14" 
                               TextColor="#6B7280" 
                               HorizontalOptions="Center"/>
                        
                        <StackLayout Orientation="Horizontal" 
                                     HorizontalOptions="Center" 
                                     Spacing="20">
                            <Button Text="Select Logo" 
                                    BackgroundColor="#3B82F6" 
                                    TextColor="White"
                                    FontFamily="InterSemiBold"
                                    FontSize="16"
                                    HeightRequest="45"
                                    WidthRequest="120"
                                    Clicked="OnSelectLogoClicked"/>
                            
                            <Button x:Name="RemoveLogoButton" 
                                    Text="Remove Logo" 
                                    BackgroundColor="#EF4444" 
                                    TextColor="White"
                                    FontFamily="InterSemiBold"
                                    FontSize="16"
                                    HeightRequest="45"
                                    WidthRequest="120"
                                    IsVisible="False"
                                    Clicked="OnRemoveLogoClicked"/>
                        </StackLayout>
                    </StackLayout>

                    <!-- Save Button -->
                    <Button Text="Save Business Information" 
                            BackgroundColor="#10B981" 
                            TextColor="White"
                            FontFamily="InterSemiBold"
                            FontSize="18"
                            HeightRequest="55"
                            Margin="20,30,20,20"
                            Clicked="OnSaveBusinessInfoClicked"/>
                </StackLayout>

                <!-- User Management Content -->
                <StackLayout x:Name="UserInfoContent" IsVisible="False" Spacing="30">
                <Label Text="User Management" 
                       FontFamily="InterBold" 
                       FontSize="28" 
                       TextColor="#111827" 
                       Margin="0,0,0,20"/>

                <!-- User Creation Section -->
                <StackLayout Spacing="20">
                    <Label Text="Create New User" 
                           FontFamily="InterSemiBold" 
                           FontSize="20" 
                           TextColor="#374151"/>

                    <StackLayout>
                        <Label Text="Name" 
                               FontFamily="InterSemiBold" 
                               FontSize="16" 
                               TextColor="#374151" 
                               Margin="0,0,0,8"/>
                        <Border BackgroundColor="White" 
                                Stroke="#D1D5DB" 
                                StrokeThickness="1" 
                                HeightRequest="50">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="4"/>
                            </Border.StrokeShape>
                            <Entry x:Name="NameEntry" 
                                   Placeholder="Enter user name" 
                                   BackgroundColor="Transparent" 
                                   TextColor="#374151"
                                   FontFamily="InterRegular"
                                   FontSize="16"
                                   Margin="12,0"/>
                        </Border>
                    </StackLayout>

                    <StackLayout>
                        <Label Text="PIN (4 digits)" 
                               FontFamily="InterSemiBold" 
                               FontSize="16" 
                               TextColor="#374151" 
                               Margin="0,0,0,8"/>
                        <Border BackgroundColor="White" 
                                Stroke="#D1D5DB" 
                                StrokeThickness="1" 
                                HeightRequest="50">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="4"/>
                            </Border.StrokeShape>
                            <Entry x:Name="PINEntry" 
                                   Placeholder="Enter 4-digit PIN" 
                                   IsPassword="True"
                                   Keyboard="Numeric"
                                   MaxLength="4"
                                   BackgroundColor="Transparent" 
                                   TextColor="#374151"
                                   FontFamily="InterRegular"
                                   FontSize="16"
                                   Margin="12,0"/>
                        </Border>
                    </StackLayout>

                    <StackLayout>
                        <Label Text="Role" 
                               FontFamily="InterSemiBold" 
                               FontSize="16" 
                               TextColor="#374151" 
                               Margin="0,0,0,8"/>
                        <Border BackgroundColor="White" 
                                Stroke="#D1D5DB" 
                                StrokeThickness="1" 
                                HeightRequest="50">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="4"/>
                            </Border.StrokeShape>
                            <Picker x:Name="RolePicker" 
                                    Title="Select Role"
                                    BackgroundColor="Transparent"
                                    TextColor="#374151"
                                    FontFamily="InterRegular"
                                    FontSize="16"
                                    Margin="12,0"/>
                        </Border>
                    </StackLayout>

                    <Border BackgroundColor="#4A5568" 
                            Stroke="#4A5568" 
                            StrokeThickness="1" 
                            HeightRequest="50"
                            Margin="0,20,0,0">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="4"/>
                        </Border.StrokeShape>
                        <Button x:Name="CreateUserButton"
                                Text="Create User" 
                                BackgroundColor="Transparent" 
                                TextColor="White"
                                FontFamily="InterSemiBold"
                                FontSize="16"
                                Clicked="OnCreateUserClicked"/>
                    </Border>
                </StackLayout>

                <!-- Existing Users Section -->
                <StackLayout Spacing="20">
                    <Label Text="Existing Users" 
                           FontFamily="InterSemiBold" 
                           FontSize="20" 
                           TextColor="#374151"/>
                    
                    <CollectionView x:Name="UsersCollectionView" 
                                    ItemsLayout="VerticalList"
                                    BackgroundColor="Transparent">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Grid Padding="20" 
                                      ColumnDefinitions="*,100,100" 
                                      RowDefinitions="Auto,Auto" 
                                      BackgroundColor="White" 
                                      Margin="0,0,0,10">
                                    <Border BackgroundColor="White"
                                            Stroke="#E5E7EB"
                                            StrokeThickness="1"
                                            Grid.RowSpan="2"
                                            Grid.ColumnSpan="3">
                                        <Border.StrokeShape>
                                            <RoundRectangle CornerRadius="8"/>
                                        </Border.StrokeShape>
                                    </Border>
                                    
                                    <Label Text="{Binding Name}" 
                                           FontFamily="InterSemiBold" 
                                           FontSize="16" 
                                           TextColor="#111827"
                                           VerticalOptions="Center"
                                           Grid.Row="0" Grid.Column="0"/>
                                    <Label Text="{Binding Role}" 
                                           FontFamily="InterMedium" 
                                           FontSize="14" 
                                           TextColor="#6B7280"
                                           Grid.Row="1" Grid.Column="0"/>
                                    
                                    <Button Text="Edit" 
                                            BackgroundColor="#F59E0B" 
                                            TextColor="White"
                                            FontSize="14"
                                            HeightRequest="40"
                                            CommandParameter="{Binding Id}"
                                            Clicked="OnEditUserClicked"
                                            Grid.Row="0" Grid.Column="1" 
                                            Grid.RowSpan="2"
                                            VerticalOptions="Center"
                                            Margin="5"/>
                                    <Button Text="Delete" 
                                            BackgroundColor="#EF4444" 
                                            TextColor="White"
                                            FontSize="14"
                                            HeightRequest="40"
                                            CommandParameter="{Binding Id}"
                                            Clicked="OnDeleteUserClicked"
                                            Grid.Row="0" Grid.Column="2" 
                                            Grid.RowSpan="2"
                                            VerticalOptions="Center"
                                            Margin="5"/>
                                </Grid>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </StackLayout>
            </StackLayout>

            <!-- OrderWeb Content -->
            <StackLayout x:Name="OrderWebContent" IsVisible="False" Spacing="30">
                <Label Text="OrderWeb Settings" 
                       FontFamily="InterBold" 
                       FontSize="28" 
                       TextColor="#111827" 
                       Margin="0,0,0,20"/>

                <!-- Order Number Settings -->
                <StackLayout Spacing="25">
                    <Label Text="Order Number Configuration" 
                           FontFamily="InterSemiBold" 
                           FontSize="20" 
                           TextColor="#374151"/>

                    <!-- Current Status Display -->
                    <Border BackgroundColor="#F8FAFC" 
                            Stroke="#E2E8F0" 
                            StrokeThickness="1" 
                            Padding="20">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="8"/>
                        </Border.StrokeShape>
                        <StackLayout Spacing="10">
                            <Label Text="Current Settings" 
                                   FontFamily="InterSemiBold" 
                                   FontSize="16" 
                                   TextColor="#374151"/>
                            <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto,Auto,Auto,Auto" RowSpacing="8">
                                <Label Text="Current Prefix:" 
                                       FontFamily="InterMedium" 
                                       FontSize="14" 
                                       TextColor="#6B7280"
                                       Grid.Row="0" Grid.Column="0"/>
                                <Label x:Name="CurrentPrefixLabel" 
                                       Text="-" 
                                       FontFamily="InterSemiBold" 
                                       FontSize="14" 
                                       TextColor="#111827"
                                       Grid.Row="0" Grid.Column="1"/>

                                <Label Text="Today's Order Count:" 
                                       FontFamily="InterMedium" 
                                       FontSize="14" 
                                       TextColor="#6B7280"
                                       Grid.Row="1" Grid.Column="0"/>
                                <Label x:Name="TodayOrderCountLabel" 
                                       Text="0" 
                                       FontFamily="InterSemiBold" 
                                       FontSize="14" 
                                       TextColor="#111827"
                                       Grid.Row="1" Grid.Column="1"/>

                                <Label Text="Next Collection #:" 
                                       FontFamily="InterMedium" 
                                       FontSize="14" 
                                       TextColor="#6B7280"
                                       Grid.Row="2" Grid.Column="0"/>
                                <Label x:Name="NextCollectionLabel" 
                                       Text="-" 
                                       FontFamily="InterSemiBold" 
                                       FontSize="14" 
                                       TextColor="#111827"
                                       Grid.Row="2" Grid.Column="1"/>

                                <Label Text="Next Delivery #:" 
                                       FontFamily="InterMedium" 
                                       FontSize="14" 
                                       TextColor="#6B7280"
                                       Grid.Row="3" Grid.Column="0"/>
                                <Label x:Name="NextDeliveryLabel" 
                                       Text="-" 
                                       FontFamily="InterSemiBold" 
                                       FontSize="14" 
                                       TextColor="#111827"
                                       Grid.Row="3" Grid.Column="1"/>

                                <Label Text="Next Table #:" 
                                       FontFamily="InterMedium" 
                                       FontSize="14" 
                                       TextColor="#6B7280"
                                       Grid.Row="4" Grid.Column="0"/>
                                <Label x:Name="NextTableLabel" 
                                       Text="-" 
                                       FontFamily="InterSemiBold" 
                                       FontSize="14" 
                                       TextColor="#111827"
                                       Grid.Row="4" Grid.Column="1"/>

                                <Label Text="Next Web #:" 
                                       FontFamily="InterMedium" 
                                       FontSize="14" 
                                       TextColor="#6B7280"
                                       Grid.Row="4" Grid.Column="0"/>
                                <Label x:Name="NextWebLabel" 
                                       Text="-" 
                                       FontFamily="InterSemiBold" 
                                       FontSize="14" 
                                       TextColor="#111827"
                                       Grid.Row="4" Grid.Column="1"/>
                            </Grid>
                        </StackLayout>
                    </Border>

                    <!-- Prefix Configuration -->
                    <StackLayout>
                        <Label Text="Order Number Prefix" 
                               FontFamily="InterSemiBold" 
                               FontSize="16" 
                               TextColor="#374151" 
                               Margin="0,0,0,8"/>
                        <Entry x:Name="PrefixEntry" 
                               Placeholder="Enter prefix (e.g., REST, CAFE)" 
                               BackgroundColor="White" 
                               TextColor="#111827"
                               FontSize="16"
                               HeightRequest="50"/>
                        <Label Text="This prefix will be added to all order numbers (e.g., REST-C-150125-001)" 
                               FontFamily="InterRegular" 
                               FontSize="12" 
                               TextColor="#9CA3AF" 
                               Margin="0,5,0,0"/>
                    </StackLayout>

                    <!-- Save Button -->
                    <Button Text="Update Order Prefix" 
                            BackgroundColor="#10B981" 
                            TextColor="White"
                            FontFamily="InterSemiBold"
                            FontSize="18"
                            HeightRequest="55"
                            Margin="0,20,0,0"
                            Clicked="OnUpdatePrefixClicked"/>
                </StackLayout>
            </StackLayout>

            <!-- Cloud Connect Content -->
            <StackLayout x:Name="CloudContent" IsVisible="False" Spacing="30">
                <Label Text="Cloud Connection" 
                       FontFamily="InterBold" 
                       FontSize="28" 
                       TextColor="#111827" 
                       Margin="0,0,0,20"/>

                <!-- Connection Fields -->
                <StackLayout Spacing="25">
                    <StackLayout>
                        <Label Text="Tenant Slug" 
                               FontFamily="InterSemiBold" 
                               FontSize="16" 
                               TextColor="#374151" 
                               Margin="0,0,0,8"/>
                        <Entry x:Name="TenantSlugEntry" 
                               Placeholder="Enter tenant slug" 
                               BackgroundColor="White" 
                               TextColor="#111827"
                               FontSize="16"
                               HeightRequest="50"/>
                    </StackLayout>

                    <StackLayout>
                        <Label Text="API Key" 
                               FontFamily="InterSemiBold" 
                               FontSize="16" 
                               TextColor="#374151" 
                               Margin="0,0,0,8"/>
                        <Grid ColumnDefinitions="*,Auto">
                            <Entry x:Name="ApiKeyEntry" 
                                   Placeholder="Enter API key"
                                   IsPassword="True"
                                   BackgroundColor="White" 
                                   TextColor="#111827"
                                   FontSize="16"
                                   HeightRequest="50"
                                   Grid.Column="0"/>
                            <Button x:Name="ToggleApiKeyButton"
                                    Text="Show"
                                    BackgroundColor="#6B7280"
                                    TextColor="White"
                                    FontSize="12"
                                    WidthRequest="60"
                                    HeightRequest="50"
                                    Clicked="OnToggleApiKeyClicked"
                                    Grid.Column="1"/>
                        </Grid>
                    </StackLayout>

                    <StackLayout>
                        <Label Text="REST API URL" 
                               FontFamily="InterSemiBold" 
                               FontSize="16" 
                               TextColor="#374151" 
                               Margin="0,0,0,8"/>
                        <Entry x:Name="RestApiUrlEntry" 
                               Placeholder="Enter REST API URL" 
                               BackgroundColor="White" 
                               TextColor="#111827"
                               FontSize="16"
                               HeightRequest="50"/>
                    </StackLayout>

                    <StackLayout>
                        <Label Text="WebSocket URL" 
                               FontFamily="InterSemiBold" 
                               FontSize="16" 
                               TextColor="#374151" 
                               Margin="0,0,0,8"/>
                        <Entry x:Name="WebSocketUrlEntry" 
                               Placeholder="Enter WebSocket URL" 
                               BackgroundColor="White" 
                               TextColor="#111827"
                               FontSize="16"
                               HeightRequest="50"/>
                    </StackLayout>
                </StackLayout>

                <!-- Connection Status -->
                <Border x:Name="ConnectionStatusFrame" 
                        BackgroundColor="#F8FAFC" 
                        Stroke="#E2E8F0" 
                        StrokeThickness="1" 
                        Padding="20"
                        IsVisible="False">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="8"/>
                    </Border.StrokeShape>
                    <StackLayout Spacing="10">
                        <Label x:Name="ConnectionStatusText" 
                               FontFamily="InterSemiBold" 
                               FontSize="16" 
                               TextColor="#374151"/>
                        <Label x:Name="ConnectionStatusDescription" 
                               FontFamily="InterRegular" 
                               FontSize="14" 
                               TextColor="#6B7280"/>
                        <Label x:Name="StatusLastCheckText" 
                               FontFamily="InterRegular" 
                               FontSize="12" 
                               TextColor="#9CA3AF"/>

                        <!-- Status Icons and Details -->
                        <Grid ColumnDefinitions="Auto,*" RowDefinitions="Auto,Auto" RowSpacing="8" ColumnSpacing="10" Margin="0,10,0,0">
                            <Label x:Name="StatusConnectionIcon" 
                                   Text="ðŸ”—" 
                                   FontSize="16"
                                   Grid.Row="0" Grid.Column="0"/>
                            <Label x:Name="StatusConnectionText" 
                                   Text="Connection Status" 
                                   FontFamily="InterMedium" 
                                   FontSize="14" 
                                   TextColor="#374151"
                                   Grid.Row="0" Grid.Column="1"/>

                            <Label x:Name="StatusApiIcon" 
                                   Text="ðŸ”‘" 
                                   FontSize="16"
                                   Grid.Row="1" Grid.Column="0"/>
                            <Label x:Name="StatusApiText" 
                                   Text="API Authentication" 
                                   FontFamily="InterMedium" 
                                   FontSize="14" 
                                   TextColor="#374151"
                                   Grid.Row="1" Grid.Column="1"/>
                        </Grid>

                        <!-- Device Info -->
                        <Label x:Name="DeviceInfoText" 
                               FontFamily="InterRegular" 
                               FontSize="12" 
                               TextColor="#9CA3AF"
                               Margin="0,10,0,0"/>
                    </StackLayout>
                </Border>

                <!-- Action Buttons -->
                <StackLayout Spacing="15">
                    <Button x:Name="ConnectButton"
                            Text="Test Connection" 
                            BackgroundColor="#3B82F6" 
                            TextColor="White"
                            FontFamily="InterSemiBold"
                            FontSize="16"
                            HeightRequest="50"
                            Clicked="OnConnectClicked"/>

                    <Grid ColumnDefinitions="*,*" ColumnSpacing="15">
                        <Button x:Name="SyncOrdersButton"
                                Text="Sync Recent Orders" 
                                BackgroundColor="#10B981" 
                                TextColor="White"
                                FontFamily="InterSemiBold"
                                FontSize="16"
                                HeightRequest="50"
                                Clicked="OnSyncOrdersClicked"
                                IsEnabled="False"
                                Grid.Column="0"/>

                        <Button x:Name="SyncHistoricalButton"
                                Text="Sync Historical" 
                                BackgroundColor="#F59E0B" 
                                TextColor="White"
                                FontFamily="InterSemiBold"
                                FontSize="16"
                                HeightRequest="50"
                                Clicked="OnSyncHistoricalClicked"
                                IsEnabled="False"
                                Grid.Column="1"/>
                    </Grid>
                </StackLayout>
            </StackLayout>

            <!-- Postcode Lookup Content -->
            <StackLayout x:Name="PostcodeLookupContent" IsVisible="False" Spacing="30">
                <Label Text="Postcode Lookup Settings" 
                       FontFamily="InterBold" 
                       FontSize="28" 
                       TextColor="#111827" 
                       Margin="0,0,0,20"/>

                <!-- Mapbox Token Configuration -->
                <StackLayout Spacing="25">
                    <Label Text="Mapbox Configuration" 
                           FontFamily="InterSemiBold" 
                           FontSize="20" 
                           TextColor="#374151"/>

                    <StackLayout>
                        <Label Text="Mapbox Access Token" 
                               FontFamily="InterSemiBold" 
                               FontSize="16" 
                               TextColor="#374151" 
                               Margin="0,0,0,8"/>
                        <Grid ColumnDefinitions="*,Auto">
                            <Entry x:Name="MapboxTokenEntry" 
                                   Placeholder="Enter Mapbox access token"
                                   IsPassword="True"
                                   BackgroundColor="White" 
                                   TextColor="#111827"
                                   FontSize="16"
                                   HeightRequest="50"
                                   Grid.Column="0"/>
                            <Button x:Name="ToggleMapboxTokenButton"
                                    Text="Show"
                                    BackgroundColor="#6B7280"
                                    TextColor="White"
                                    FontSize="12"
                                    WidthRequest="60"
                                    HeightRequest="50"
                                    Clicked="OnToggleMapboxTokenClicked"
                                    Grid.Column="1"/>
                        </Grid>
                    </StackLayout>

                    <!-- Status Display -->
                    <Border x:Name="MapboxStatusFrame" 
                            BackgroundColor="#F8FAFC" 
                            Stroke="#E2E8F0" 
                            StrokeThickness="1" 
                            Padding="20"
                            IsVisible="False">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="8"/>
                        </Border.StrokeShape>
                        <StackLayout Spacing="10">
                            <Grid ColumnDefinitions="Auto,*" ColumnSpacing="10">
                                <Label x:Name="MapboxStatusIcon" 
                                       Text="âœ…" 
                                       FontSize="16"
                                       Grid.Column="0"/>
                                <Label x:Name="MapboxStatusText" 
                                       Text="Mapbox Token Status" 
                                       FontFamily="InterMedium" 
                                       FontSize="14" 
                                       TextColor="#374151"
                                       Grid.Column="1"/>
                            </Grid>
                        </StackLayout>
                    </Border>

                    <!-- Action Buttons -->
                    <StackLayout Spacing="15">
                        <Button x:Name="SavePostcodeButton"
                                Text="Save Settings" 
                                BackgroundColor="#10B981" 
                                TextColor="White"
                                FontFamily="InterSemiBold"
                                FontSize="16"
                                HeightRequest="50"
                                Clicked="OnSavePostcodeSettingsClicked"/>

                        <Button x:Name="TestMapboxButton"
                                Text="Test Mapbox Connection" 
                                BackgroundColor="#3B82F6" 
                                TextColor="White"
                                FontFamily="InterSemiBold"
                                FontSize="16"
                                HeightRequest="50"
                                Clicked="OnTestMapboxClicked"/>
                    </StackLayout>
                </StackLayout>
            </StackLayout>
        </StackLayout>
        </ScrollView>
    </Grid>
</ContentPage>