<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="POS_in_NET.Pages.CloudSettingsPage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             Title="OrderWeb.net Integration">
    <ScrollView BackgroundColor="#F5F7FA">
        <StackLayout Padding="30" Spacing="25">
            
            <Label Text="ðŸŒ OrderWeb.net Integration" 
                   FontSize="32" 
                   FontAttributes="Bold"
                   TextColor="#2C3E50"
                   HorizontalOptions="Center" 
                   Margin="0,10,0,20" />

            <Frame BackgroundColor="White" 
                   HasShadow="True" 
                   CornerRadius="12" 
                   Padding="20">
                <Label x:Name="StatusLabel"
                       Text="ðŸ”´ Not configured"
                       FontSize="18"
                       FontAttributes="Bold"
                       TextColor="#DC3545"
                       HorizontalOptions="Center" />
            </Frame>

            <Frame BackgroundColor="White" 
                   HasShadow="True" 
                   CornerRadius="15" 
                   Padding="25">
                <StackLayout Spacing="20">
                    
                    <StackLayout Spacing="15">
                        <Label Text="ðŸ” API Configuration" 
                               FontSize="22" 
                               FontAttributes="Bold"
                               TextColor="#495057" />
                        
                        <StackLayout Spacing="5">
                            <Label Text="Restaurant ID" 
                                   FontSize="14" 
                                   TextColor="#6C757D" 
                                   FontAttributes="Bold"/>
                            <Entry x:Name="TenantSlugEntry"
                                   Placeholder="kitchen"
                                   FontSize="15"
                                   BackgroundColor="#F8F9FA"
                                   TextColor="#495057"/>
                            <Label Text="Your unique restaurant identifier from OrderWeb.net dashboard"
                                   FontSize="12"
                                   TextColor="#6C757D"/>
                        </StackLayout>

                        <StackLayout Spacing="5">
                            <Label Text="API Key" 
                                   FontSize="14" 
                                   TextColor="#6C757D" 
                                   FontAttributes="Bold"/>
                            <Entry x:Name="ApiKeyEntry"
                                   Placeholder="pos_..."
                                   FontSize="15"
                                   BackgroundColor="#F8F9FA"
                                   TextColor="#495057"
                                   IsPassword="True"/>
                            <Label Text="Your secure API key from OrderWeb.net dashboard"
                                   FontSize="12"
                                   TextColor="#6C757D"/>
                        </StackLayout>
                    </StackLayout>

                    <BoxView HeightRequest="1" BackgroundColor="#DEE2E6"/>

                    <StackLayout Spacing="15">
                        <Label Text="ðŸŒ REST API" 
                               FontSize="22" 
                               FontAttributes="Bold"
                               TextColor="#495057" />
                        
                        <StackLayout Spacing="5">
                            <Label Text="Base URL" 
                                   FontSize="14" 
                                   TextColor="#6C757D" 
                                   FontAttributes="Bold"/>
                            <Entry x:Name="RestApiBaseUrlEntry"
                                   Placeholder="https://orderweb.net/api"
                                   Text="https://orderweb.net/api"
                                   FontSize="15"
                                   BackgroundColor="#F8F9FA"
                                   TextColor="#495057"
                                   TextChanged="OnRestApiBaseUrlChanged"/>
                        </StackLayout>

                        <StackLayout Spacing="5">
                            <Label Text="Endpoint (Restaurant Path)" 
                                   FontSize="14" 
                                   TextColor="#6C757D" 
                                   FontAttributes="Bold"/>
                            <Entry x:Name="RestApiEndpointEntry"
                                   Placeholder="/kitchen"
                                   FontSize="15"
                                   BackgroundColor="#F8F9FA"
                                   TextColor="#495057"
                                   TextChanged="OnRestApiEndpointChanged"/>
                            <Label Text="Leave empty to use Restaurant ID"
                                   FontSize="12"
                                   TextColor="#6C757D"/>
                        </StackLayout>

                        <Frame BackgroundColor="#E7F3FF" 
                               HasShadow="False" 
                               CornerRadius="8" 
                               Padding="12">
                            <StackLayout Spacing="5">
                                <Label Text="ðŸ“ Full REST API URL:" 
                                       FontSize="13" 
                                       FontAttributes="Bold"
                                       TextColor="#004085" />
                                <Label x:Name="FullRestApiUrlLabel"
                                       Text="https://orderweb.net/api/kitchen"
                                       FontSize="13"
                                       TextColor="#004085"
                                       LineBreakMode="WordWrap"/>
                            </StackLayout>
                        </Frame>
                    </StackLayout>

                    <BoxView HeightRequest="1" BackgroundColor="#DEE2E6"/>

                    <StackLayout Spacing="15">
                        <Label Text="âš¡ WebSocket Connection" 
                               FontSize="22" 
                               FontAttributes="Bold"
                               TextColor="#495057" />
                        
                        <StackLayout Spacing="5">
                            <Label Text="WebSocket URL" 
                                   FontSize="14" 
                                   TextColor="#6C757D" 
                                   FontAttributes="Bold"/>
                            <Entry x:Name="WebSocketUrlEntry"
                                   Placeholder="wss://orderweb.net/ws/pos"
                                   Text="wss://orderweb.net/ws/pos"
                                   FontSize="15"
                                   BackgroundColor="#F8F9FA"
                                   TextColor="#495057"
                                   TextChanged="OnWebSocketUrlChanged"/>
                        </StackLayout>

                        <Frame BackgroundColor="#E7F3FF" 
                               HasShadow="False" 
                               CornerRadius="8" 
                               Padding="12">
                            <StackLayout Spacing="5">
                                <Label Text="ðŸ“ Full WebSocket URL:" 
                                       FontSize="13" 
                                       FontAttributes="Bold"
                                       TextColor="#004085" />
                                <Label x:Name="FullWebSocketUrlLabel"
                                       Text="wss://orderweb.net/ws/pos/kitchen"
                                       FontSize="13"
                                       TextColor="#004085"
                                       LineBreakMode="WordWrap"/>
                            </StackLayout>
                        </Frame>
                    </StackLayout>

                    <BoxView HeightRequest="1" BackgroundColor="#DEE2E6"/>

                    <StackLayout Spacing="15">
                        <Label Text="âš™ï¸ Additional Settings" 
                               FontSize="22" 
                               FontAttributes="Bold"
                               TextColor="#495057" />

                        <Grid ColumnSpacing="15">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            
                            <StackLayout Grid.Column="0" Spacing="5">
                                <Label Text="Connection Timeout (seconds)" 
                                       FontSize="14" 
                                       TextColor="#6C757D" 
                                       FontAttributes="Bold"/>
                                <Entry x:Name="ConnectionTimeoutEntry"
                                       Text="30"
                                       Keyboard="Numeric"
                                       FontSize="15"
                                       BackgroundColor="#F8F9FA"
                                       TextColor="#495057"/>
                            </StackLayout>

                            <StackLayout Grid.Column="1" Spacing="5">
                                <Label Text="Max Retry Attempts" 
                                       FontSize="14" 
                                       TextColor="#6C757D" 
                                       FontAttributes="Bold"/>
                                <Entry x:Name="MaxRetryAttemptsEntry"
                                       Text="3"
                                       Keyboard="Numeric"
                                       FontSize="15"
                                       BackgroundColor="#F8F9FA"
                                       TextColor="#495057"/>
                            </StackLayout>
                        </Grid>

                        <StackLayout Orientation="Horizontal" Spacing="10">
                            <CheckBox x:Name="AutoPrintCheckBox" IsChecked="True" />
                            <Label Text="Auto-print new orders" 
                                   VerticalOptions="Center"
                                   TextColor="#495057" />
                        </StackLayout>

                        <StackLayout Orientation="Horizontal" Spacing="10">
                            <CheckBox x:Name="NotificationsCheckBox" IsChecked="True" />
                            <Label Text="Enable notifications" 
                                   VerticalOptions="Center"
                                   TextColor="#495057" />
                        </StackLayout>
                    </StackLayout>

                    <Button Text="ðŸ’¾ Save Settings"
                            Clicked="OnSaveSettingsClicked"
                            BackgroundColor="#28A745"
                            TextColor="White"
                            FontSize="16"
                            FontAttributes="Bold"
                            CornerRadius="8"
                            HeightRequest="50"
                            Margin="0,20,0,0" />

                    <Button x:Name="TestConnectionButton"
                            Text="ðŸ” Test Connection"
                            Clicked="OnTestConnectionClicked"
                            BackgroundColor="#007BFF"
                            TextColor="White"
                            FontSize="16"
                            CornerRadius="8"
                            HeightRequest="50"
                            Margin="0,10,0,0"
                            IsEnabled="False" />

                    <Frame x:Name="TestResultsFrame"
                           BackgroundColor="#F8F9FA"
                           HasShadow="False"
                           CornerRadius="8"
                           Padding="15"
                           IsVisible="False"
                           Margin="0,10,0,0">
                        <StackLayout Spacing="8">
                            <Label Text="Connection Test Results:" 
                                   FontSize="14" 
                                   FontAttributes="Bold"
                                   TextColor="#495057" />
                            <Label x:Name="ApiTestResultLabel"
                                   FontSize="13"
                                   TextColor="#495057" />
                            <Label x:Name="WebSocketTestResultLabel"
                                   FontSize="13"
                                   TextColor="#495057" />
                        </StackLayout>
                    </Frame>

                    <Button Text="ðŸš€ Start Live Orders"
                            Clicked="OnStartLiveOrdersClicked"
                            BackgroundColor="#17A2B8"
                            TextColor="White"
                            FontSize="18"
                            FontAttributes="Bold"
                            CornerRadius="8"
                            HeightRequest="55"
                            Margin="0,20,0,0" />
                </StackLayout>
            </Frame>

            <Frame BackgroundColor="#D1ECF1" 
                   HasShadow="False" 
                   BorderColor="#17A2B8"
                   CornerRadius="10" 
                   Padding="20">
                <StackLayout Spacing="10">
                    <Label Text="â„¹ï¸ How it works" 
                           FontSize="18" 
                           FontAttributes="Bold"
                           TextColor="#0C5460" />
                    <Label TextColor="#0C5460" FontSize="14">
                        <Label.FormattedText>
                            <FormattedString>
                                <Span Text="âš¡ WebSocket: " FontAttributes="Bold" />
                                <Span Text="Receives orders instantly (0-100ms)"/>
                                <Span Text="&#10;"/>
                                <Span Text="ðŸ“¡ REST API: " FontAttributes="Bold" />
                                <Span Text="Gift cards &amp; loyalty queries on-demand"/>
                                <Span Text="&#10;"/>
                                <Span Text="ðŸ“Š Background Sync: " FontAttributes="Bold" />
                                <Span Text="Daily reports uploaded automatically"/>
                            </FormattedString>
                        </Label.FormattedText>
                    </Label>
                </StackLayout>
            </Frame>

        </StackLayout>
    </ScrollView>
</ContentPage>
