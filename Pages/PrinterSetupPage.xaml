<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:views="clr-namespace:POS_in_NET.Views"
             x:Class="POS_in_NET.Pages.PrinterSetupPage"
             BackgroundColor="#F1F5F9"
             Shell.NavBarIsVisible="False">

    <AbsoluteLayout>
        <!-- Main Content -->
        <Grid RowDefinitions="Auto,*"
              AbsoluteLayout.LayoutBounds="0,0,1,1"
              AbsoluteLayout.LayoutFlags="All">
        <!-- Top Bar -->
        <views:TopBar x:Name="TopBar" Grid.Row="0"/>
        
        <!-- Content -->
        <ScrollView Grid.Row="1">
            <Grid Padding="32" ColumnDefinitions="*,Auto" ColumnSpacing="32">
                
                <!-- Left: Printer List -->
                <VerticalStackLayout Grid.Column="0" Spacing="24">
                    
                    <!-- Header -->
                    <Grid ColumnDefinitions="*,Auto">
                        <VerticalStackLayout Grid.Column="0" Spacing="6">
                            <Label Text="Network Printers"
                                   FontSize="32"
                                   FontAttributes="Bold"
                                   TextColor="#0F172A"/>
                            <Label x:Name="PrinterCountLabel"
                                   Text="0 printers configured"
                                   FontSize="15"
                                   TextColor="#64748B"/>
                        </VerticalStackLayout>
                        
                        <HorizontalStackLayout Grid.Column="1" Spacing="12" VerticalOptions="Center">
                            <Button x:Name="RefreshButton"
                                    Text="Refresh"
                                    BackgroundColor="#E2E8F0"
                                    TextColor="#475569"
                                    CornerRadius="8"
                                    Padding="20,12"
                                    FontAttributes="Bold"
                                    Clicked="OnRefreshClicked"/>
                            <Button x:Name="AddPrinterButton"
                                    Text="+ Add Printer"
                                    BackgroundColor="#0F172A"
                                    TextColor="White"
                                    CornerRadius="8"
                                    Padding="20,12"
                                    FontAttributes="Bold"
                                    Clicked="OnAddPrinterClicked"/>
                        </HorizontalStackLayout>
                    </Grid>

                    <!-- Status Cards -->
                    <Grid ColumnDefinitions="*,*,*,*" ColumnSpacing="16">
                        <!-- Online -->
                        <Border BackgroundColor="White" Padding="20" StrokeThickness="0">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="12"/>
                            </Border.StrokeShape>
                            <Border.Shadow>
                                <Shadow Brush="#0A000000" Offset="0,2" Radius="8" Opacity="0.08"/>
                            </Border.Shadow>
                            <VerticalStackLayout Spacing="8">
                                <HorizontalStackLayout Spacing="8">
                                    <BoxView WidthRequest="10" HeightRequest="10" CornerRadius="5" BackgroundColor="#22C55E" VerticalOptions="Center"/>
                                    <Label Text="ONLINE" FontSize="11" FontAttributes="Bold" TextColor="#64748B" CharacterSpacing="1"/>
                                </HorizontalStackLayout>
                                <Label x:Name="OnlineCountLabel" Text="0" FontSize="28" FontAttributes="Bold" TextColor="#0F172A"/>
                            </VerticalStackLayout>
                        </Border>
                        
                        <!-- Offline -->
                        <Border Grid.Column="1" BackgroundColor="White" Padding="20" StrokeThickness="0">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="12"/>
                            </Border.StrokeShape>
                            <Border.Shadow>
                                <Shadow Brush="#0A000000" Offset="0,2" Radius="8" Opacity="0.08"/>
                            </Border.Shadow>
                            <VerticalStackLayout Spacing="8">
                                <HorizontalStackLayout Spacing="8">
                                    <BoxView WidthRequest="10" HeightRequest="10" CornerRadius="5" BackgroundColor="#EF4444" VerticalOptions="Center"/>
                                    <Label Text="OFFLINE" FontSize="11" FontAttributes="Bold" TextColor="#64748B" CharacterSpacing="1"/>
                                </HorizontalStackLayout>
                                <Label x:Name="OfflineCountLabel" Text="0" FontSize="28" FontAttributes="Bold" TextColor="#0F172A"/>
                            </VerticalStackLayout>
                        </Border>
                        
                        <!-- Queue -->
                        <Border Grid.Column="2" BackgroundColor="White" Padding="20" StrokeThickness="0">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="12"/>
                            </Border.StrokeShape>
                            <Border.Shadow>
                                <Shadow Brush="#0A000000" Offset="0,2" Radius="8" Opacity="0.08"/>
                            </Border.Shadow>
                            <VerticalStackLayout Spacing="8">
                                <HorizontalStackLayout Spacing="8">
                                    <BoxView WidthRequest="10" HeightRequest="10" CornerRadius="5" BackgroundColor="#6366F1" VerticalOptions="Center"/>
                                    <Label Text="IN QUEUE" FontSize="11" FontAttributes="Bold" TextColor="#64748B" CharacterSpacing="1"/>
                                </HorizontalStackLayout>
                                <Label x:Name="QueueCountLabel" Text="0" FontSize="28" FontAttributes="Bold" TextColor="#0F172A"/>
                            </VerticalStackLayout>
                        </Border>
                        
                        <!-- Last Check -->
                        <Border Grid.Column="3" BackgroundColor="White" Padding="20" StrokeThickness="0">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="12"/>
                            </Border.StrokeShape>
                            <Border.Shadow>
                                <Shadow Brush="#0A000000" Offset="0,2" Radius="8" Opacity="0.08"/>
                            </Border.Shadow>
                            <VerticalStackLayout Spacing="8">
                                <Label Text="LAST CHECK" FontSize="11" FontAttributes="Bold" TextColor="#64748B" CharacterSpacing="1"/>
                                <Label x:Name="LastCheckLabel" Text="Never" FontSize="18" FontAttributes="Bold" TextColor="#0F172A"/>
                            </VerticalStackLayout>
                        </Border>
                    </Grid>

                    <!-- Quick Actions -->
                    <Border BackgroundColor="White" Padding="20" StrokeThickness="0">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="12"/>
                        </Border.StrokeShape>
                        <Border.Shadow>
                            <Shadow Brush="#0A000000" Offset="0,2" Radius="8" Opacity="0.08"/>
                        </Border.Shadow>
                        <HorizontalStackLayout Spacing="12">
                            <Button x:Name="TestAllButton"
                                    Text="Test All"
                                    BackgroundColor="#3B82F6"
                                    TextColor="White"
                                    CornerRadius="8"
                                    Padding="20,12"
                                    FontAttributes="Bold"
                                    Clicked="OnTestAllClicked"/>
                            <Button x:Name="CheckStatusButton"
                                    Text="Check Status"
                                    BackgroundColor="#8B5CF6"
                                    TextColor="White"
                                    CornerRadius="8"
                                    Padding="20,12"
                                    FontAttributes="Bold"
                                    Clicked="OnCheckStatusClicked"/>
                            <Button x:Name="OpenDrawerButton"
                                    Text="Open Drawer"
                                    BackgroundColor="#F59E0B"
                                    TextColor="White"
                                    CornerRadius="8"
                                    Padding="20,12"
                                    FontAttributes="Bold"
                                    Clicked="OnOpenDrawerClicked"/>
                        </HorizontalStackLayout>
                    </Border>

                    <!-- Receipt Printers Section -->
                    <VerticalStackLayout Spacing="12">
                        <Label Text="Receipt Printers" FontSize="18" FontAttributes="Bold" TextColor="#0F172A"/>
                        <VerticalStackLayout x:Name="ReceiptPrintersContainer" Spacing="12">
                            <Label x:Name="NoReceiptPrintersLabel" 
                                   Text="No receipt printers configured" 
                                   TextColor="#94A3B8" 
                                   FontSize="14"
                                   IsVisible="True"/>
                        </VerticalStackLayout>
                    </VerticalStackLayout>

                    <!-- Kitchen Printers Section -->
                    <VerticalStackLayout Spacing="12">
                        <Label Text="Kitchen Printers" FontSize="18" FontAttributes="Bold" TextColor="#0F172A"/>
                        <VerticalStackLayout x:Name="KitchenPrintersContainer" Spacing="12">
                            <Label x:Name="NoKitchenPrintersLabel" 
                                   Text="No kitchen printers configured" 
                                   TextColor="#94A3B8" 
                                   FontSize="14"
                                   IsVisible="True"/>
                        </VerticalStackLayout>
                    </VerticalStackLayout>

                    <!-- Bar Printers Section -->
                    <VerticalStackLayout Spacing="12">
                        <Label Text="Bar Printers" FontSize="18" FontAttributes="Bold" TextColor="#0F172A"/>
                        <VerticalStackLayout x:Name="BarPrintersContainer" Spacing="12">
                            <Label x:Name="NoBarPrintersLabel" 
                                   Text="No bar printers configured" 
                                   TextColor="#94A3B8" 
                                   FontSize="14"
                                   IsVisible="True"/>
                        </VerticalStackLayout>
                    </VerticalStackLayout>

                    <!-- Online Order Printers Section -->
                    <VerticalStackLayout Spacing="12">
                        <HorizontalStackLayout Spacing="10">
                            <Label Text="Online Order Printers" FontSize="18" FontAttributes="Bold" TextColor="#0F172A"/>
                            <Border BackgroundColor="#3B82F6" Padding="8,4" StrokeThickness="0">
                                <Border.StrokeShape>
                                    <RoundRectangle CornerRadius="4"/>
                                </Border.StrokeShape>
                                <Label Text="ORDERWEB" FontSize="10" FontAttributes="Bold" TextColor="White"/>
                            </Border>
                        </HorizontalStackLayout>
                        <VerticalStackLayout x:Name="OnlinePrintersContainer" Spacing="12">
                            <Label x:Name="NoOnlinePrintersLabel" 
                                   Text="No online order printers configured" 
                                   TextColor="#94A3B8" 
                                   FontSize="14"
                                   IsVisible="True"/>
                        </VerticalStackLayout>
                    </VerticalStackLayout>

                    <!-- Takeaway Printers Section -->
                    <VerticalStackLayout Spacing="12">
                        <HorizontalStackLayout Spacing="10">
                            <Label Text="Takeaway Printers" FontSize="18" FontAttributes="Bold" TextColor="#0F172A"/>
                            <Border BackgroundColor="#F97316" Padding="8,4" StrokeThickness="0">
                                <Border.StrokeShape>
                                    <RoundRectangle CornerRadius="4"/>
                                </Border.StrokeShape>
                                <Label Text="KITCHEN TICKET" FontSize="10" FontAttributes="Bold" TextColor="White"/>
                            </Border>
                        </HorizontalStackLayout>
                        <VerticalStackLayout x:Name="TakeawayPrintersContainer" Spacing="12">
                            <Label x:Name="NoTakeawayPrintersLabel" 
                                   Text="No takeaway printers configured" 
                                   TextColor="#94A3B8" 
                                   FontSize="14"
                                   IsVisible="True"/>
                        </VerticalStackLayout>
                    </VerticalStackLayout>

                </VerticalStackLayout>

                <!-- Right: Add/Edit Form Panel -->
                <Border x:Name="FormPanel"
                        Grid.Column="1"
                        BackgroundColor="White"
                        WidthRequest="420"
                        Padding="28"
                        StrokeThickness="0"
                        IsVisible="False">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="16"/>
                    </Border.StrokeShape>
                    <Border.Shadow>
                        <Shadow Brush="#15000000" Offset="0,8" Radius="24" Opacity="0.12"/>
                    </Border.Shadow>
                    
                    <ScrollView>
                        <VerticalStackLayout Spacing="20">
                            <!-- Form Header -->
                            <Grid ColumnDefinitions="*,Auto">
                                <Label x:Name="FormTitle"
                                       Text="Add Printer"
                                       FontSize="22"
                                       FontAttributes="Bold"
                                       TextColor="#0F172A"/>
                                <Border Grid.Column="1"
                                        BackgroundColor="#F1F5F9"
                                        Padding="8"
                                        StrokeThickness="0"
                                        WidthRequest="36"
                                        HeightRequest="36">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="8"/>
                                    </Border.StrokeShape>
                                    <Border.GestureRecognizers>
                                        <TapGestureRecognizer Tapped="OnCloseFormClicked"/>
                                    </Border.GestureRecognizers>
                                    <Label Text="âœ•" 
                                           FontSize="16" 
                                           TextColor="#64748B" 
                                           HorizontalOptions="Center" 
                                           VerticalOptions="Center"/>
                                </Border>
                            </Grid>

                            <BoxView HeightRequest="1" BackgroundColor="#E2E8F0"/>

                            <!-- Printer Name -->
                            <VerticalStackLayout Spacing="8">
                                <Label Text="Printer Name" FontSize="13" FontAttributes="Bold" TextColor="#475569"/>
                                <Border BackgroundColor="#F8FAFC" Padding="14,12" StrokeThickness="1" Stroke="#E2E8F0">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="8"/>
                                    </Border.StrokeShape>
                                    <Entry x:Name="PrinterNameEntry"
                                           Placeholder="e.g., Kitchen Hot, Front Counter"
                                           BackgroundColor="Transparent"
                                           TextColor="#0F172A"
                                           PlaceholderColor="#94A3B8"
                                           FontSize="15"/>
                                </Border>
                            </VerticalStackLayout>

                            <!-- IP Address -->
                            <VerticalStackLayout Spacing="8">
                                <Label Text="IP Address" FontSize="13" FontAttributes="Bold" TextColor="#475569"/>
                                <Border BackgroundColor="#F8FAFC" Padding="14,12" StrokeThickness="1" Stroke="#E2E8F0">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="8"/>
                                    </Border.StrokeShape>
                                    <Entry x:Name="IpAddressEntry"
                                           Placeholder="e.g., 192.168.1.100"
                                           Keyboard="Url"
                                           BackgroundColor="Transparent"
                                           TextColor="#0F172A"
                                           PlaceholderColor="#94A3B8"
                                           FontSize="15"/>
                                </Border>
                            </VerticalStackLayout>

                            <!-- Port -->
                            <VerticalStackLayout Spacing="8">
                                <Label Text="Port" FontSize="13" FontAttributes="Bold" TextColor="#475569"/>
                                <Border BackgroundColor="#F8FAFC" Padding="14,12" StrokeThickness="1" Stroke="#E2E8F0">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="8"/>
                                    </Border.StrokeShape>
                                    <Entry x:Name="PortEntry"
                                           Text="9100"
                                           Keyboard="Numeric"
                                           BackgroundColor="Transparent"
                                           TextColor="#0F172A"
                                           FontSize="15"/>
                                </Border>
                            </VerticalStackLayout>

                            <!-- Printer Brand -->
                            <VerticalStackLayout Spacing="8">
                                <Label Text="Brand" FontSize="13" FontAttributes="Bold" TextColor="#475569"/>
                                <HorizontalStackLayout Spacing="10">
                                    <Border x:Name="BrandEpsonBorder" 
                                            BackgroundColor="#0F172A" 
                                            Padding="18,12" 
                                            StrokeThickness="0">
                                        <Border.StrokeShape>
                                            <RoundRectangle CornerRadius="8"/>
                                        </Border.StrokeShape>
                                        <Border.GestureRecognizers>
                                            <TapGestureRecognizer Tapped="OnBrandEpsonTapped"/>
                                        </Border.GestureRecognizers>
                                        <Label x:Name="BrandEpsonLabel" Text="EPSON" FontSize="12" FontAttributes="Bold" TextColor="White"/>
                                    </Border>
                                    <Border x:Name="BrandStarBorder" 
                                            BackgroundColor="#F1F5F9" 
                                            Padding="18,12"
                                            StrokeThickness="0">
                                        <Border.StrokeShape>
                                            <RoundRectangle CornerRadius="8"/>
                                        </Border.StrokeShape>
                                        <Border.GestureRecognizers>
                                            <TapGestureRecognizer Tapped="OnBrandStarTapped"/>
                                        </Border.GestureRecognizers>
                                        <Label x:Name="BrandStarLabel" Text="STAR" FontSize="12" FontAttributes="Bold" TextColor="#64748B"/>
                                    </Border>
                                    <Border x:Name="BrandOtherBorder" 
                                            BackgroundColor="#F1F5F9" 
                                            Padding="18,12"
                                            StrokeThickness="0">
                                        <Border.StrokeShape>
                                            <RoundRectangle CornerRadius="8"/>
                                        </Border.StrokeShape>
                                        <Border.GestureRecognizers>
                                            <TapGestureRecognizer Tapped="OnBrandOtherTapped"/>
                                        </Border.GestureRecognizers>
                                        <Label x:Name="BrandOtherLabel" Text="OTHER" FontSize="12" FontAttributes="Bold" TextColor="#64748B"/>
                                    </Border>
                                </HorizontalStackLayout>
                            </VerticalStackLayout>

                            <!-- Printer Type -->
                            <VerticalStackLayout Spacing="8">
                                <Label Text="Type" FontSize="13" FontAttributes="Bold" TextColor="#475569"/>
                                <FlexLayout Wrap="Wrap" JustifyContent="Start" AlignItems="Start">
                                    <Border x:Name="TypeReceiptBorder" 
                                            BackgroundColor="#22C55E" 
                                            Padding="18,12"
                                            Margin="0,0,10,10"
                                            StrokeThickness="0">
                                        <Border.StrokeShape>
                                            <RoundRectangle CornerRadius="8"/>
                                        </Border.StrokeShape>
                                        <Border.GestureRecognizers>
                                            <TapGestureRecognizer Tapped="OnTypeReceiptTapped"/>
                                        </Border.GestureRecognizers>
                                        <Label x:Name="TypeReceiptLabel" Text="Receipt" FontSize="12" FontAttributes="Bold" TextColor="White"/>
                                    </Border>
                                    <Border x:Name="TypeKitchenBorder" 
                                            BackgroundColor="#F1F5F9" 
                                            Padding="18,12"
                                            Margin="0,0,10,10"
                                            StrokeThickness="0">
                                        <Border.StrokeShape>
                                            <RoundRectangle CornerRadius="8"/>
                                        </Border.StrokeShape>
                                        <Border.GestureRecognizers>
                                            <TapGestureRecognizer Tapped="OnTypeKitchenTapped"/>
                                        </Border.GestureRecognizers>
                                        <Label x:Name="TypeKitchenLabel" Text="Kitchen" FontSize="12" FontAttributes="Bold" TextColor="#64748B"/>
                                    </Border>
                                    <Border x:Name="TypeBarBorder" 
                                            BackgroundColor="#F1F5F9" 
                                            Padding="18,12"
                                            Margin="0,0,10,10"
                                            StrokeThickness="0">
                                        <Border.StrokeShape>
                                            <RoundRectangle CornerRadius="8"/>
                                        </Border.StrokeShape>
                                        <Border.GestureRecognizers>
                                            <TapGestureRecognizer Tapped="OnTypeBarTapped"/>
                                        </Border.GestureRecognizers>
                                        <Label x:Name="TypeBarLabel" Text="Bar" FontSize="12" FontAttributes="Bold" TextColor="#64748B"/>
                                    </Border>
                                    <Border x:Name="TypeOnlineBorder" 
                                            BackgroundColor="#F1F5F9" 
                                            Padding="18,12"
                                            Margin="0,0,10,10"
                                            StrokeThickness="0">
                                        <Border.StrokeShape>
                                            <RoundRectangle CornerRadius="8"/>
                                        </Border.StrokeShape>
                                        <Border.GestureRecognizers>
                                            <TapGestureRecognizer Tapped="OnTypeOnlineTapped"/>
                                        </Border.GestureRecognizers>
                                        <Label x:Name="TypeOnlineLabel" Text="Online" FontSize="12" FontAttributes="Bold" TextColor="#64748B"/>
                                    </Border>
                                    <Border x:Name="TypeTakeawayBorder" 
                                            BackgroundColor="#F1F5F9" 
                                            Padding="18,12"
                                            Margin="0,0,10,10"
                                            StrokeThickness="0">
                                        <Border.StrokeShape>
                                            <RoundRectangle CornerRadius="8"/>
                                        </Border.StrokeShape>
                                        <Border.GestureRecognizers>
                                            <TapGestureRecognizer Tapped="OnTypeTakeawayTapped"/>
                                        </Border.GestureRecognizers>
                                        <Label x:Name="TypeTakeawayLabel" Text="Takeaway" FontSize="12" FontAttributes="Bold" TextColor="#64748B"/>
                                    </Border>
                                </FlexLayout>
                            </VerticalStackLayout>

                            <!-- Paper Width -->
                            <VerticalStackLayout Spacing="8">
                                <Label Text="Paper Width" FontSize="13" FontAttributes="Bold" TextColor="#475569"/>
                                <HorizontalStackLayout Spacing="10">
                                    <Border x:Name="Width80Border" 
                                            BackgroundColor="#0F172A" 
                                            Padding="24,12"
                                            StrokeThickness="0">
                                        <Border.StrokeShape>
                                            <RoundRectangle CornerRadius="8"/>
                                        </Border.StrokeShape>
                                        <Border.GestureRecognizers>
                                            <TapGestureRecognizer Tapped="OnWidth80Tapped"/>
                                        </Border.GestureRecognizers>
                                        <Label x:Name="Width80Label" Text="80mm" FontSize="12" FontAttributes="Bold" TextColor="White"/>
                                    </Border>
                                    <Border x:Name="Width58Border" 
                                            BackgroundColor="#F1F5F9" 
                                            Padding="24,12"
                                            StrokeThickness="0">
                                        <Border.StrokeShape>
                                            <RoundRectangle CornerRadius="8"/>
                                        </Border.StrokeShape>
                                        <Border.GestureRecognizers>
                                            <TapGestureRecognizer Tapped="OnWidth58Tapped"/>
                                        </Border.GestureRecognizers>
                                        <Label x:Name="Width58Label" Text="58mm" FontSize="12" FontAttributes="Bold" TextColor="#64748B"/>
                                    </Border>
                                </HorizontalStackLayout>
                            </VerticalStackLayout>

                            <!-- Print Group Assignment -->
                            <VerticalStackLayout Spacing="8">
                                <Label Text="Print Group" FontSize="13" FontAttributes="Bold" TextColor="#475569"/>
                                <Label Text="Enter a print group name for menu item routing (e.g., Kitchen, Bar, Grill)" 
                                       FontSize="11" 
                                       TextColor="#94A3B8"
                                       Margin="0,0,0,4"/>
                                <Border BackgroundColor="White" Padding="14,12" StrokeThickness="1" Stroke="#E2E8F0">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="8"/>
                                    </Border.StrokeShape>
                                    <Entry x:Name="PrintGroupEntry"
                                           Placeholder="e.g., Kitchen, Bar, Grill, Takeaway, Label Printer"
                                           FontSize="15"
                                           TextColor="#0F172A"
                                           PlaceholderColor="#94A3B8"
                                           BackgroundColor="Transparent"
                                           HorizontalOptions="FillAndExpand"/>
                                </Border>
                            </VerticalStackLayout>

                            <!-- Features -->
                            <VerticalStackLayout Spacing="12">
                                <Label Text="Features" FontSize="13" FontAttributes="Bold" TextColor="#475569"/>
                                
                                <Border BackgroundColor="#F8FAFC" Padding="16" StrokeThickness="0">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="10"/>
                                    </Border.StrokeShape>
                                    <VerticalStackLayout Spacing="14">
                                        <HorizontalStackLayout Spacing="12">
                                            <CheckBox x:Name="CashDrawerCheckbox" Color="#22C55E" WidthRequest="24" HeightRequest="24"/>
                                            <Label Text="Cash Drawer" VerticalOptions="Center" TextColor="#334155" FontSize="14"/>
                                        </HorizontalStackLayout>
                                        
                                        <HorizontalStackLayout Spacing="12">
                                            <CheckBox x:Name="CutterCheckbox" IsChecked="True" Color="#22C55E" WidthRequest="24" HeightRequest="24"/>
                                            <Label Text="Auto Cutter" VerticalOptions="Center" TextColor="#334155" FontSize="14"/>
                                        </HorizontalStackLayout>
                                        
                                        <HorizontalStackLayout Spacing="12">
                                            <CheckBox x:Name="BuzzerCheckbox" Color="#22C55E" WidthRequest="24" HeightRequest="24"/>
                                            <Label Text="Buzzer Alert" VerticalOptions="Center" TextColor="#334155" FontSize="14"/>
                                        </HorizontalStackLayout>
                                    </VerticalStackLayout>
                                </Border>
                            </VerticalStackLayout>

                            <!-- Test Connection -->
                            <Button x:Name="TestConnectionButton"
                                    Text="Test Connection"
                                    BackgroundColor="#6366F1"
                                    TextColor="White"
                                    CornerRadius="10"
                                    Padding="16,14"
                                    FontAttributes="Bold"
                                    FontSize="14"
                                    Clicked="OnTestConnectionClicked"/>

                            <Label x:Name="ConnectionStatusLabel"
                                   Text="Not tested"
                                   FontSize="13"
                                   TextColor="#94A3B8"
                                   HorizontalOptions="Center"/>

                            <BoxView HeightRequest="1" BackgroundColor="#E2E8F0"/>

                            <!-- Action Buttons -->
                            <Grid ColumnDefinitions="*,*" ColumnSpacing="12">
                                <Button Grid.Column="0"
                                        Text="Cancel"
                                        BackgroundColor="#F1F5F9"
                                        TextColor="#475569"
                                        CornerRadius="10"
                                        Padding="16,14"
                                        FontAttributes="Bold"
                                        FontSize="14"
                                        Clicked="OnCloseFormClicked"/>
                                <Button x:Name="SavePrinterButton"
                                        Grid.Column="1"
                                        Text="Save Printer"
                                        BackgroundColor="#0F172A"
                                        TextColor="White"
                                        CornerRadius="10"
                                        Padding="16,14"
                                        FontAttributes="Bold"
                                        FontSize="14"
                                        Clicked="OnSavePrinterClicked"/>
                            </Grid>
                        </VerticalStackLayout>
                    </ScrollView>
                </Border>
            </Grid>
        </ScrollView>
        </Grid>
        
        <!-- Dialog Overlay Container (Always on top) -->
        <ContentView x:Name="DialogOverlay"
                     AbsoluteLayout.LayoutBounds="0,0,1,1"
                     AbsoluteLayout.LayoutFlags="All"
                     IsVisible="False"
                     InputTransparent="False" />
    </AbsoluteLayout>
</ContentPage>
